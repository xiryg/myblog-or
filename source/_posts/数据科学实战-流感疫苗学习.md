---
title: 数据科学实战-流感疫苗学习
tags: 机器学习
swiper_index: 11
categories: 数据科学
description: 流感疫苗学习-预测 H1N1 和季节性流感疫苗
cover: 'https://img.tucang.cc/api/image/show/9357feaf45d191a27d272a81ef4b9242'
abbrlink: 1464bdc3
date: 2023-12-28 18:44:58
---

<h1 style="color: blue;">Flu Shot Learning: Predict H1N1 and Seasonal Flu Vaccines</h1>

# 一、赛题目标

流感疫苗学习：利用个体在背景、观点和健康行为方面分享的信息，预测其是否接种了H1N1 和 季节性流感疫苗.

赛题地址：[Flu Shot Learning: Predict H1N1 and Seasonal Flu Vaccines](https://www.drivendata.org/competitions/66/flu-shot-learning/)

# 二、数据集解读与初步探索


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
```

## 1. 数据集解读

首先进行数据读取：


```python
# 加载特征数据集
features_df = pd.read_csv("data_sets/training_set_features.csv",
                          index_col='respondent_id')

# 加载标签数据集
labels_df = pd.read_csv("data_sets/training_set_labels.csv",
                        index_col='respondent_id')

# 加载测试集特征数据集
test_df = pd.read_csv("data_sets/test_set_features.csv",
                     index_col='respondent_id')

# 合并特征和标签数据集
join_df = features_df.join(labels_df)
join_df.to_csv('data_sets/join_df.csv')
```

- features_df 训练数据集：

&emsp;&emsp;训练数据集基本情况如下


```python
# 数据整体观测
print('features_df -- shape：', features_df.shape)  # 查看数据规模
features_df.head() # 查看前五条信息
```

    features_df -- shape： (26707, 35)





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h1n1_concern</th>
      <th>h1n1_knowledge</th>
      <th>behavioral_antiviral_meds</th>
      <th>behavioral_avoidance</th>
      <th>behavioral_face_mask</th>
      <th>behavioral_wash_hands</th>
      <th>behavioral_large_gatherings</th>
      <th>behavioral_outside_home</th>
      <th>behavioral_touch_face</th>
      <th>doctor_recc_h1n1</th>
      <th>...</th>
      <th>income_poverty</th>
      <th>marital_status</th>
      <th>rent_or_own</th>
      <th>employment_status</th>
      <th>hhs_geo_region</th>
      <th>census_msa</th>
      <th>household_adults</th>
      <th>household_children</th>
      <th>employment_industry</th>
      <th>employment_occupation</th>
    </tr>
    <tr>
      <th>respondent_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>Below Poverty</td>
      <td>Not Married</td>
      <td>Own</td>
      <td>Not in Labor Force</td>
      <td>oxchjgsf</td>
      <td>Non-MSA</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>Below Poverty</td>
      <td>Not Married</td>
      <td>Rent</td>
      <td>Employed</td>
      <td>bhuqouqj</td>
      <td>MSA, Not Principle  City</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>pxcmvdjn</td>
      <td>xgwztkwe</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>&lt;= $75,000, Above Poverty</td>
      <td>Not Married</td>
      <td>Own</td>
      <td>Employed</td>
      <td>qufhixun</td>
      <td>MSA, Not Principle  City</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>rucpziij</td>
      <td>xtkaffoo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>Below Poverty</td>
      <td>Not Married</td>
      <td>Rent</td>
      <td>Not in Labor Force</td>
      <td>lrircsnp</td>
      <td>MSA, Principle City</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>&lt;= $75,000, Above Poverty</td>
      <td>Married</td>
      <td>Own</td>
      <td>Employed</td>
      <td>qufhixun</td>
      <td>MSA, Not Principle  City</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>wxleyezf</td>
      <td>emcorrxb</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 35 columns</p>
</div>




`features_df` 数据集的每行都是一个调查受访者，`respondent_id` 是唯一的随机标识符，列是与受访者对应的特征值。


```python
# 查看数据集信息
features_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 26707 entries, 0 to 26706
    Data columns (total 35 columns):
     #   Column                       Non-Null Count  Dtype  
    ---  ------                       --------------  -----  
     0   h1n1_concern                 26615 non-null  float64
     1   h1n1_knowledge               26591 non-null  float64
     2   behavioral_antiviral_meds    26636 non-null  float64
     3   behavioral_avoidance         26499 non-null  float64
     4   behavioral_face_mask         26688 non-null  float64
     5   behavioral_wash_hands        26665 non-null  float64
     6   behavioral_large_gatherings  26620 non-null  float64
     7   behavioral_outside_home      26625 non-null  float64
     8   behavioral_touch_face        26579 non-null  float64
     9   doctor_recc_h1n1             24547 non-null  float64
     10  doctor_recc_seasonal         24547 non-null  float64
     11  chronic_med_condition        25736 non-null  float64
     12  child_under_6_months         25887 non-null  float64
     13  health_worker                25903 non-null  float64
     14  health_insurance             14433 non-null  float64
     15  opinion_h1n1_vacc_effective  26316 non-null  float64
     16  opinion_h1n1_risk            26319 non-null  float64
     17  opinion_h1n1_sick_from_vacc  26312 non-null  float64
     18  opinion_seas_vacc_effective  26245 non-null  float64
     19  opinion_seas_risk            26193 non-null  float64
     20  opinion_seas_sick_from_vacc  26170 non-null  float64
     21  age_group                    26707 non-null  object 
     22  education                    25300 non-null  object 
     23  race                         26707 non-null  object 
     24  sex                          26707 non-null  object 
     25  income_poverty               22284 non-null  object 
     26  marital_status               25299 non-null  object 
     27  rent_or_own                  24665 non-null  object 
     28  employment_status            25244 non-null  object 
     29  hhs_geo_region               26707 non-null  object 
     30  census_msa                   26707 non-null  object 
     31  household_adults             26458 non-null  float64
     32  household_children           26458 non-null  float64
     33  employment_industry          13377 non-null  object 
     34  employment_occupation        13237 non-null  object 
    dtypes: float64(23), object(12)
    memory usage: 8.3+ MB


- test_df 测试数据集：


```python
# 数据整体观测
print('test_df -- shape：', test_df.shape)  # 查看数据规模
test_df.head() # 查看前五条信息   和 submssion一致
```

    test_df -- shape： (26708, 35)





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h1n1_concern</th>
      <th>h1n1_knowledge</th>
      <th>behavioral_antiviral_meds</th>
      <th>behavioral_avoidance</th>
      <th>behavioral_face_mask</th>
      <th>behavioral_wash_hands</th>
      <th>behavioral_large_gatherings</th>
      <th>behavioral_outside_home</th>
      <th>behavioral_touch_face</th>
      <th>doctor_recc_h1n1</th>
      <th>...</th>
      <th>income_poverty</th>
      <th>marital_status</th>
      <th>rent_or_own</th>
      <th>employment_status</th>
      <th>hhs_geo_region</th>
      <th>census_msa</th>
      <th>household_adults</th>
      <th>household_children</th>
      <th>employment_industry</th>
      <th>employment_occupation</th>
    </tr>
    <tr>
      <th>respondent_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26707</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>&gt; $75,000</td>
      <td>Not Married</td>
      <td>Rent</td>
      <td>Employed</td>
      <td>mlyzmhmf</td>
      <td>MSA, Not Principle  City</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>atmlpfrs</td>
      <td>hfxkjkmi</td>
    </tr>
    <tr>
      <th>26708</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>Below Poverty</td>
      <td>Not Married</td>
      <td>Rent</td>
      <td>Employed</td>
      <td>bhuqouqj</td>
      <td>Non-MSA</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>atmlpfrs</td>
      <td>xqwwgdyp</td>
    </tr>
    <tr>
      <th>26709</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>&gt; $75,000</td>
      <td>Married</td>
      <td>Own</td>
      <td>Employed</td>
      <td>lrircsnp</td>
      <td>Non-MSA</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>nduyfdeo</td>
      <td>pvmttkik</td>
    </tr>
    <tr>
      <th>26710</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>&lt;= $75,000, Above Poverty</td>
      <td>Married</td>
      <td>Own</td>
      <td>Not in Labor Force</td>
      <td>lrircsnp</td>
      <td>MSA, Not Principle  City</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26711</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>&lt;= $75,000, Above Poverty</td>
      <td>Not Married</td>
      <td>Own</td>
      <td>Employed</td>
      <td>lzgpxyit</td>
      <td>Non-MSA</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>fcxhlnwr</td>
      <td>mxkfnird</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 35 columns</p>
</div>




```python
test_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 26708 entries, 26707 to 53414
    Data columns (total 35 columns):
     #   Column                       Non-Null Count  Dtype  
    ---  ------                       --------------  -----  
     0   h1n1_concern                 26623 non-null  float64
     1   h1n1_knowledge               26586 non-null  float64
     2   behavioral_antiviral_meds    26629 non-null  float64
     3   behavioral_avoidance         26495 non-null  float64
     4   behavioral_face_mask         26689 non-null  float64
     5   behavioral_wash_hands        26668 non-null  float64
     6   behavioral_large_gatherings  26636 non-null  float64
     7   behavioral_outside_home      26626 non-null  float64
     8   behavioral_touch_face        26580 non-null  float64
     9   doctor_recc_h1n1             24548 non-null  float64
     10  doctor_recc_seasonal         24548 non-null  float64
     11  chronic_med_condition        25776 non-null  float64
     12  child_under_6_months         25895 non-null  float64
     13  health_worker                25919 non-null  float64
     14  health_insurance             14480 non-null  float64
     15  opinion_h1n1_vacc_effective  26310 non-null  float64
     16  opinion_h1n1_risk            26328 non-null  float64
     17  opinion_h1n1_sick_from_vacc  26333 non-null  float64
     18  opinion_seas_vacc_effective  26256 non-null  float64
     19  opinion_seas_risk            26209 non-null  float64
     20  opinion_seas_sick_from_vacc  26187 non-null  float64
     21  age_group                    26708 non-null  object 
     22  education                    25301 non-null  object 
     23  race                         26708 non-null  object 
     24  sex                          26708 non-null  object 
     25  income_poverty               22211 non-null  object 
     26  marital_status               25266 non-null  object 
     27  rent_or_own                  24672 non-null  object 
     28  employment_status            25237 non-null  object 
     29  hhs_geo_region               26708 non-null  object 
     30  census_msa                   26708 non-null  object 
     31  household_adults             26483 non-null  float64
     32  household_children           26483 non-null  float64
     33  employment_industry          13433 non-null  object 
     34  employment_occupation        13282 non-null  object 
    dtypes: float64(23), object(12)
    memory usage: 7.3+ MB


**从上述可以看出训练集和测试集的字段解释一致** 

- labels_df 标签数据集：


```python
print("labels_df -- shape：",labels_df.shape)
labels_df.head()
```

    labels_df -- shape： (26707, 2)





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h1n1_vaccine</th>
      <th>seasonal_vaccine</th>
    </tr>
    <tr>
      <th>respondent_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



* `h1n1_vaccine` - 受访者是否接种过 H1N1 流感疫苗。
* `seasonal_vaccine` - 受访者是否接种了季节性流感疫苗。

两者都是二进制变量：`0` = 否； `1` = 是。一些受访者没有接种任何一种疫苗，其他人只接种了一种疫苗，还有一些受访者两种疫苗都接种了

## 2. 数据质量分析 

&emsp;&emsp;接下来进行简单的数据探索，首先校验数据的正确性，并检验缺失值，异常值等情况。

- 数据的正确性校验

&emsp;&emsp;正确性校验，校验数据本身是否符合逻辑，此数据集将 `respondent_id` 作为唯一的随机标识符，将验证其是否独一无二，并且训练集和测试集的 `respondent_id` 无重复。


```python
# 检验训练集 respondent_id 无重复
features_df.index.nunique() == features_df.shape[0]
```




    True




```python
# 判断 'respondent_id' 是否匹配
assert features_df.index.equals(labels_df.index),"索引不匹配"
```


```python
# 检验测试集 respondent_id 无重复
test_df.index.nunique() == test_df.shape[0]
```




    True



- 检验数据缺失情况

&emsp;&emsp;接下来进一步分析


```python
# 计算缺失值数量
missing_values = features_df.isnull().sum(axis=0)

# 计算缺失值占比
missing_percentage = (missing_values / len(features_df)) * 100

# 获取每列的数据类型
column_types = features_df.dtypes

# 创建包含缺失值数量、缺失值占比和数据类型的 DataFrame
missing_info_df = pd.DataFrame({'miss_values': missing_values, 'miss_per': missing_percentage, 'data_type': column_types})

# 按缺失值占比降序排列
missing_info_df = missing_info_df.sort_values(by='miss_per', ascending=False)

print(missing_info_df)

```

                                 miss_values   miss_per data_type
    employment_occupation              13470  50.436215    object
    employment_industry                13330  49.912008    object
    health_insurance                   12274  45.957989   float64
    income_poverty                      4423  16.561201    object
    doctor_recc_h1n1                    2160   8.087767   float64
    doctor_recc_seasonal                2160   8.087767   float64
    rent_or_own                         2042   7.645936    object
    employment_status                   1463   5.477965    object
    marital_status                      1408   5.272026    object
    education                           1407   5.268282    object
    chronic_med_condition                971   3.635751   float64
    child_under_6_months                 820   3.070356   float64
    health_worker                        804   3.010447   float64
    opinion_seas_sick_from_vacc          537   2.010709   float64
    opinion_seas_risk                    514   1.924589   float64
    opinion_seas_vacc_effective          462   1.729884   float64
    opinion_h1n1_sick_from_vacc          395   1.479013   float64
    opinion_h1n1_vacc_effective          391   1.464036   float64
    opinion_h1n1_risk                    388   1.452803   float64
    household_children                   249   0.932340   float64
    household_adults                     249   0.932340   float64
    behavioral_avoidance                 208   0.778822   float64
    behavioral_touch_face                128   0.479275   float64
    h1n1_knowledge                       116   0.434343   float64
    h1n1_concern                          92   0.344479   float64
    behavioral_large_gatherings           87   0.325757   float64
    behavioral_outside_home               82   0.307036   float64
    behavioral_antiviral_meds             71   0.265848   float64
    behavioral_wash_hands                 42   0.157262   float64
    behavioral_face_mask                  19   0.071142   float64
    sex                                    0   0.000000    object
    race                                   0   0.000000    object
    hhs_geo_region                         0   0.000000    object
    census_msa                             0   0.000000    object
    age_group                              0   0.000000    object


发现缺失值挺多，尤其是缺失值占比最大的两个字段
- `employment_industry` - 受访者所从事的行业类型。值表示为短随机字符串。
- `employment_occupation` - 受访者的职业类型。值表示为短随机字符串。


```python
employment_industry = features_df['employment_industry'].nunique()
employment_occupation = features_df['employment_occupation'].nunique()
(employment_industry,employment_occupation)
```




    (21, 23)



可能为了保护受访者的隐私，这两个的字段的信息隐藏起来了，无法直接解读其的含义。


```python
# 统计描述
features_df.describe().T.round(4)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>h1n1_concern</th>
      <td>26615.0</td>
      <td>1.6185</td>
      <td>0.9103</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>h1n1_knowledge</th>
      <td>26591.0</td>
      <td>1.2625</td>
      <td>0.6181</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>behavioral_antiviral_meds</th>
      <td>26636.0</td>
      <td>0.0488</td>
      <td>0.2155</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>behavioral_avoidance</th>
      <td>26499.0</td>
      <td>0.7256</td>
      <td>0.4462</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>behavioral_face_mask</th>
      <td>26688.0</td>
      <td>0.0690</td>
      <td>0.2534</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>behavioral_wash_hands</th>
      <td>26665.0</td>
      <td>0.8256</td>
      <td>0.3794</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>behavioral_large_gatherings</th>
      <td>26620.0</td>
      <td>0.3586</td>
      <td>0.4796</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>behavioral_outside_home</th>
      <td>26625.0</td>
      <td>0.3373</td>
      <td>0.4728</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>behavioral_touch_face</th>
      <td>26579.0</td>
      <td>0.6773</td>
      <td>0.4675</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>doctor_recc_h1n1</th>
      <td>24547.0</td>
      <td>0.2203</td>
      <td>0.4145</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>doctor_recc_seasonal</th>
      <td>24547.0</td>
      <td>0.3297</td>
      <td>0.4701</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>chronic_med_condition</th>
      <td>25736.0</td>
      <td>0.2833</td>
      <td>0.4506</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>child_under_6_months</th>
      <td>25887.0</td>
      <td>0.0826</td>
      <td>0.2753</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>health_worker</th>
      <td>25903.0</td>
      <td>0.1119</td>
      <td>0.3153</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>health_insurance</th>
      <td>14433.0</td>
      <td>0.8797</td>
      <td>0.3253</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>opinion_h1n1_vacc_effective</th>
      <td>26316.0</td>
      <td>3.8506</td>
      <td>1.0074</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>opinion_h1n1_risk</th>
      <td>26319.0</td>
      <td>2.3426</td>
      <td>1.2855</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>opinion_h1n1_sick_from_vacc</th>
      <td>26312.0</td>
      <td>2.3577</td>
      <td>1.3628</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>opinion_seas_vacc_effective</th>
      <td>26245.0</td>
      <td>4.0260</td>
      <td>1.0866</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>opinion_seas_risk</th>
      <td>26193.0</td>
      <td>2.7192</td>
      <td>1.3851</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>opinion_seas_sick_from_vacc</th>
      <td>26170.0</td>
      <td>2.1181</td>
      <td>1.3329</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>household_adults</th>
      <td>26458.0</td>
      <td>0.8865</td>
      <td>0.7534</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>household_children</th>
      <td>26458.0</td>
      <td>0.5346</td>
      <td>0.9282</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>



******

# 三、相关特征交叉统计及可视化

首先选取 `h1n1_concern` (类别型特征）- 对H1N1流感的关心程度
- 0= 完全不关心；1= 不太关心；2= 有点担心；3= 非常关心。


```python
counts = (join_df[['h1n1_concern', 'h1n1_vaccine']]
              .groupby(['h1n1_concern', 'h1n1_vaccine'])
              .size()
              .unstack('h1n1_vaccine')
         )
counts
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>h1n1_vaccine</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>h1n1_concern</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>2849</td>
      <td>447</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>6756</td>
      <td>1397</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>8102</td>
      <td>2473</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>3250</td>
      <td>1341</td>
    </tr>
  </tbody>
</table>
</div>



观察 `h1n1_concern` 不同关注程度下，是否接种 `h1n1_vaccine` ，但肉眼很难看清楚。


```python
h1n1_concern_counts = counts.sum(axis='columns') # 计算不同关心程度下受访者数量
h1n1_concern_counts
```




    h1n1_concern
    0.0     3296
    1.0     8153
    2.0    10575
    3.0     4591
    dtype: int64




```python
props = counts.div(h1n1_concern_counts, axis='index')  # 占比统计
props
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>h1n1_vaccine</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>h1n1_concern</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.864381</td>
      <td>0.135619</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>0.828652</td>
      <td>0.171348</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>0.766147</td>
      <td>0.233853</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>0.707907</td>
      <td>0.292093</td>
    </tr>
  </tbody>
</table>
</div>




```python
ax = props.plot.barh(stacked=True)
ax.invert_yaxis()
ax.legend(
    loc='center left',
    bbox_to_anchor=(1.05, 0.5),
    title='h1n1_vaccine'
)
```




    <matplotlib.legend.Legend at 0x19c036968d0>




![output_41_1](https://img.tucang.cc/api/image/show/244a0af5c0a098e10c06117d6f859da6)
    



```python
def vaccination_rate_plot(col, target, data, ax=None):

    counts = (join_df[[target, col]]
                  .groupby([target, col])
                  .size()
                  .unstack(target)
             )
    group_counts = counts.sum(axis='columns')
    props = counts.div(group_counts, axis='index')

    props.plot(kind="barh", stacked=True, ax=ax)
    ax.invert_yaxis()
    ax.legend().remove()
```


```python
cols_to_plot = [
    'h1n1_concern',
    'h1n1_knowledge',
    'opinion_h1n1_vacc_effective',
    'opinion_h1n1_risk',
    'opinion_h1n1_sick_from_vacc',
    'opinion_seas_vacc_effective',
    'opinion_seas_risk',
    'opinion_seas_sick_from_vacc',
    'sex',
    'age_group',
    'race',
    'census_msa',
    'education',
    'employment_status',
    'hhs_geo_region',
    'household_adults',
    'household_children',
    'marital_status',
    'income_poverty',
    'rent_or_own'
]

fig, ax = plt.subplots(
    len(cols_to_plot), 2, figsize=(9,len(cols_to_plot)*2.5)
)
for idx, col in enumerate(cols_to_plot):
    vaccination_rate_plot(
        col, 'h1n1_vaccine', join_df, ax=ax[idx, 0]
    )
    vaccination_rate_plot(
        col, 'seasonal_vaccine', join_df, ax=ax[idx, 1]
    )

ax[0, 0].legend(
    loc='lower center', bbox_to_anchor=(0.5, 1.05), title='h1n1_vaccine'
)
ax[0, 1].legend(
    loc='lower center', bbox_to_anchor=(0.5, 1.05), title='seasonal_vaccine'
)
fig.tight_layout()
```


![output_43_0](https://img.tucang.cc/api/image/show/a0a05aeed00af74cef873b4f2bc64b86)
    


# 四、数据预处理

## 1. 缺失值填充策略

将数据集的特征分为 **数值型**、**分类型**、**有序型** 三种，分别进行填充插补.

![output1](https://img.tucang.cc/api/image/show/f5bc1cafcb3dde2bc5b62a4a7e17ce4b)


下面使用 [sklearn.impute.SimpleImputer](https://scikit-learn.org.cn/view/763.html) 来进行缺失值插补.


```python
from sklearn.impute import SimpleImputer
```


```python
numeric_cols = features_df.select_dtypes('number').columns
# 数值型的列
```


```python
categorical_cols = ['race', 'sex', 'marital_status', 'rent_or_own',  'hhs_geo_region',
       'census_msa', 'employment_industry', 'employment_occupation']
# 分类型的列
```


```python
ordinal_cols = ['age_group', 'education',  'income_poverty',
        'employment_status']
# 有序型的列
```


```python
# 判断有无遗漏的特征
assert len(numeric_cols)+len(ordinal_cols)+len(categorical_cols) == features_df.shape[1]
```

- 在数值型列当中，基本为二元或多元变量，取某一特定值，我原本在这里取众数来填充，可是训练效果并不好，所以我选择平均值（尽管它不是连续的量），可结果是后者的训练效果更好。

&emsp;&emsp;我在这里的理解，假如说一个特征（0-1），一共有十个，有7个缺失值，其中有一个1，两个0，原本的数据分布是1:2；但如果按照众数填充，就变成了1:9,势必会造成数据分布的偏移，从而影响模型训练。


```python
# 对训练集和测试集的数值型特征进行填充
imputer = SimpleImputer(strategy='mean') # 平均值填充

numeric_cols_1 = features_df.select_dtypes('number')
numeric_cols_2 = test_df.select_dtypes('number')

filled_numeric_cols_1 = imputer.fit_transform(numeric_cols_1) # (26707, 23)
filled_numeric_cols_2 = imputer.fit_transform(numeric_cols_2)
features_df[numeric_cols_1.columns] = filled_numeric_cols_1
test_df[numeric_cols_2.columns] = filled_numeric_cols_2
```

- 分类列采用，常数填充，设置值为 `missing`


```python
imputer = SimpleImputer(strategy='constant', fill_value='missing')

# 对分类列进行拟合和转换
filled_categorical_cols_1 = imputer.fit_transform(features_df[categorical_cols])
filled_categorical_cols_2 = imputer.fit_transform(test_df[categorical_cols])

features_df[categorical_cols] = filled_categorical_cols_1
test_df[categorical_cols] = filled_categorical_cols_2
```

- 有序列，用众数填充。 


```python
imputer = SimpleImputer(strategy='most_frequent')

# 对有序型列进行拟合和转换
filled_ordinal_cols_1 = imputer.fit_transform(features_df[ordinal_cols])
filled_ordinal_cols_2 = imputer.fit_transform(test_df[ordinal_cols])

features_df[ordinal_cols] = filled_ordinal_cols_1
test_df[ordinal_cols] = filled_ordinal_cols_2
```


```python
features_df[numeric_cols_1.columns].corr(numeric_only=True).style.background_gradient(cmap='coolwarm').format(precision=2)
```




<style type="text/css">
#T_42f38_row0_col0, #T_42f38_row1_col1, #T_42f38_row2_col2, #T_42f38_row3_col3, #T_42f38_row4_col4, #T_42f38_row5_col5, #T_42f38_row6_col6, #T_42f38_row7_col7, #T_42f38_row8_col8, #T_42f38_row9_col9, #T_42f38_row10_col10, #T_42f38_row11_col11, #T_42f38_row12_col12, #T_42f38_row13_col13, #T_42f38_row14_col14, #T_42f38_row15_col15, #T_42f38_row16_col16, #T_42f38_row17_col17, #T_42f38_row18_col18, #T_42f38_row19_col19, #T_42f38_row20_col20, #T_42f38_row21_col21, #T_42f38_row22_col22 {
  background-color: #b40426;
  color: #f1f1f1;
}
#T_42f38_row0_col1, #T_42f38_row3_col15, #T_42f38_row3_col19, #T_42f38_row5_col11, #T_42f38_row6_col16, #T_42f38_row7_col10, #T_42f38_row8_col11, #T_42f38_row9_col6, #T_42f38_row9_col22 {
  background-color: #6180e9;
  color: #f1f1f1;
}
#T_42f38_row0_col2, #T_42f38_row1_col15, #T_42f38_row3_col11, #T_42f38_row3_col22, #T_42f38_row6_col10, #T_42f38_row7_col18, #T_42f38_row8_col4, #T_42f38_row9_col17, #T_42f38_row10_col6, #T_42f38_row13_col22, #T_42f38_row14_col10, #T_42f38_row16_col1, #T_42f38_row17_col3, #T_42f38_row17_col4, #T_42f38_row17_col8 {
  background-color: #6384eb;
  color: #f1f1f1;
}
#T_42f38_row0_col3, #T_42f38_row5_col6, #T_42f38_row9_col11, #T_42f38_row10_col18, #T_42f38_row20_col0 {
  background-color: #86a9fc;
  color: #f1f1f1;
}
#T_42f38_row0_col4, #T_42f38_row18_col11 {
  background-color: #7396f5;
  color: #f1f1f1;
}
#T_42f38_row0_col5, #T_42f38_row0_col6, #T_42f38_row0_col18, #T_42f38_row8_col6 {
  background-color: #9abbff;
  color: #000000;
}
#T_42f38_row0_col7 {
  background-color: #9dbdff;
  color: #000000;
}
#T_42f38_row0_col8, #T_42f38_row0_col15, #T_42f38_row9_col16, #T_42f38_row15_col0, #T_42f38_row16_col9, #T_42f38_row19_col20 {
  background-color: #8caffe;
  color: #000000;
}
#T_42f38_row0_col9, #T_42f38_row1_col14, #T_42f38_row5_col10, #T_42f38_row5_col20, #T_42f38_row5_col22, #T_42f38_row8_col19, #T_42f38_row10_col7, #T_42f38_row10_col14, #T_42f38_row17_col5 {
  background-color: #6687ed;
  color: #f1f1f1;
}
#T_42f38_row0_col10, #T_42f38_row2_col4, #T_42f38_row4_col0, #T_42f38_row5_col17, #T_42f38_row17_col11, #T_42f38_row19_col6 {
  background-color: #7093f3;
  color: #f1f1f1;
}
#T_42f38_row0_col11, #T_42f38_row2_col7, #T_42f38_row3_col18, #T_42f38_row16_col7, #T_42f38_row16_col22 {
  background-color: #7597f6;
  color: #f1f1f1;
}
#T_42f38_row0_col12, #T_42f38_row1_col16, #T_42f38_row1_col19, #T_42f38_row9_col21, #T_42f38_row13_col8, #T_42f38_row13_col15, #T_42f38_row14_col13, #T_42f38_row15_col20, #T_42f38_row18_col4, #T_42f38_row19_col12, #T_42f38_row20_col10, #T_42f38_row22_col13 {
  background-color: #4f69d9;
  color: #f1f1f1;
}
#T_42f38_row0_col13, #T_42f38_row4_col3, #T_42f38_row6_col15, #T_42f38_row7_col9, #T_42f38_row7_col15, #T_42f38_row8_col14, #T_42f38_row8_col21, #T_42f38_row9_col3, #T_42f38_row12_col0, #T_42f38_row12_col4, #T_42f38_row12_col6, #T_42f38_row15_col4, #T_42f38_row21_col12, #T_42f38_row22_col0 {
  background-color: #4e68d8;
  color: #f1f1f1;
}
#T_42f38_row0_col14, #T_42f38_row0_col21, #T_42f38_row2_col1, #T_42f38_row4_col15, #T_42f38_row5_col12, #T_42f38_row10_col12, #T_42f38_row10_col22, #T_42f38_row11_col2, #T_42f38_row14_col22, #T_42f38_row20_col9, #T_42f38_row20_col18, #T_42f38_row22_col7 {
  background-color: #4a63d3;
  color: #f1f1f1;
}
#T_42f38_row0_col16 {
  background-color: #b6cefa;
  color: #000000;
}
#T_42f38_row0_col17 {
  background-color: #b7cff9;
  color: #000000;
}
#T_42f38_row0_col19 {
  background-color: #a7c5fe;
  color: #000000;
}
#T_42f38_row0_col20, #T_42f38_row3_col7, #T_42f38_row7_col8, #T_42f38_row19_col15, #T_42f38_row21_col22 {
  background-color: #93b5fe;
  color: #000000;
}
#T_42f38_row0_col22, #T_42f38_row1_col22, #T_42f38_row4_col20, #T_42f38_row6_col18, #T_42f38_row8_col1, #T_42f38_row8_col16, #T_42f38_row8_col20, #T_42f38_row10_col0, #T_42f38_row11_col6, #T_42f38_row14_col11, #T_42f38_row15_col9, #T_42f38_row17_col18, #T_42f38_row18_col1, #T_42f38_row19_col8, #T_42f38_row20_col11 {
  background-color: #6788ee;
  color: #f1f1f1;
}
#T_42f38_row1_col0, #T_42f38_row1_col11, #T_42f38_row4_col5, #T_42f38_row4_col9, #T_42f38_row5_col21, #T_42f38_row6_col9, #T_42f38_row9_col5, #T_42f38_row10_col2, #T_42f38_row12_col10, #T_42f38_row13_col21, #T_42f38_row15_col2, #T_42f38_row15_col21, #T_42f38_row17_col15 {
  background-color: #516ddb;
  color: #f1f1f1;
}
#T_42f38_row1_col2, #T_42f38_row6_col21, #T_42f38_row7_col12, #T_42f38_row11_col3, #T_42f38_row12_col14, #T_42f38_row21_col7, #T_42f38_row21_col17, #T_42f38_row22_col5, #T_42f38_row22_col6 {
  background-color: #455cce;
  color: #f1f1f1;
}
#T_42f38_row1_col3, #T_42f38_row1_col8, #T_42f38_row1_col21, #T_42f38_row6_col22, #T_42f38_row7_col22, #T_42f38_row10_col5, #T_42f38_row10_col13, #T_42f38_row10_col17, #T_42f38_row13_col14, #T_42f38_row20_col8, #T_42f38_row20_col21, #T_42f38_row21_col1, #T_42f38_row21_col2 {
  background-color: #5572df;
  color: #f1f1f1;
}
#T_42f38_row1_col4, #T_42f38_row2_col5, #T_42f38_row4_col12, #T_42f38_row11_col15, #T_42f38_row13_col2, #T_42f38_row14_col15, #T_42f38_row17_col12, #T_42f38_row20_col12 {
  background-color: #4b64d5;
  color: #f1f1f1;
}
#T_42f38_row1_col5, #T_42f38_row2_col19, #T_42f38_row3_col14, #T_42f38_row4_col21, #T_42f38_row5_col9, #T_42f38_row5_col14, #T_42f38_row8_col9, #T_42f38_row10_col20, #T_42f38_row12_col7, #T_42f38_row12_col16, #T_42f38_row17_col21, #T_42f38_row20_col3, #T_42f38_row20_col5, #T_42f38_row21_col20 {
  background-color: #536edd;
  color: #f1f1f1;
}
#T_42f38_row1_col6, #T_42f38_row1_col7, #T_42f38_row1_col20, #T_42f38_row6_col13, #T_42f38_row7_col1, #T_42f38_row7_col13, #T_42f38_row11_col21, #T_42f38_row11_col22, #T_42f38_row12_col3, #T_42f38_row13_col3, #T_42f38_row14_col2, #T_42f38_row14_col4, #T_42f38_row14_col12, #T_42f38_row14_col16, #T_42f38_row14_col17, #T_42f38_row21_col0, #T_42f38_row21_col5, #T_42f38_row21_col8, #T_42f38_row21_col9, #T_42f38_row21_col14, #T_42f38_row21_col19, #T_42f38_row22_col10, #T_42f38_row22_col11, #T_42f38_row22_col15, #T_42f38_row22_col18 {
  background-color: #3b4cc0;
  color: #f1f1f1;
}
#T_42f38_row1_col9, #T_42f38_row2_col18, #T_42f38_row3_col21, #T_42f38_row5_col13, #T_42f38_row9_col8, #T_42f38_row12_col1, #T_42f38_row13_col19, #T_42f38_row15_col13, #T_42f38_row15_col17, #T_42f38_row15_col22 {
  background-color: #5470de;
  color: #f1f1f1;
}
#T_42f38_row1_col10, #T_42f38_row3_col10, #T_42f38_row3_col16, #T_42f38_row5_col4, #T_42f38_row15_col3, #T_42f38_row15_col7, #T_42f38_row22_col1, #T_42f38_row22_col20 {
  background-color: #5d7ce6;
  color: #f1f1f1;
}
#T_42f38_row1_col12, #T_42f38_row2_col13, #T_42f38_row6_col12, #T_42f38_row7_col21, #T_42f38_row13_col20, #T_42f38_row17_col13, #T_42f38_row18_col20, #T_42f38_row21_col4, #T_42f38_row22_col3 {
  background-color: #465ecf;
  color: #f1f1f1;
}
#T_42f38_row1_col13, #T_42f38_row7_col17, #T_42f38_row20_col16, #T_42f38_row20_col19 {
  background-color: #799cf8;
  color: #f1f1f1;
}
#T_42f38_row1_col17, #T_42f38_row11_col13, #T_42f38_row14_col6, #T_42f38_row20_col1, #T_42f38_row21_col10 {
  background-color: #3c4ec2;
  color: #f1f1f1;
}
#T_42f38_row1_col18, #T_42f38_row3_col17, #T_42f38_row8_col17, #T_42f38_row16_col13 {
  background-color: #6a8bef;
  color: #f1f1f1;
}
#T_42f38_row2_col0, #T_42f38_row2_col11, #T_42f38_row4_col8, #T_42f38_row4_col19, #T_42f38_row11_col14, #T_42f38_row11_col17, #T_42f38_row15_col8, #T_42f38_row16_col12, #T_42f38_row17_col9, #T_42f38_row18_col8 {
  background-color: #5a78e4;
  color: #f1f1f1;
}
#T_42f38_row2_col3, #T_42f38_row2_col12, #T_42f38_row13_col0, #T_42f38_row14_col9, #T_42f38_row21_col18 {
  background-color: #4961d2;
  color: #f1f1f1;
}
#T_42f38_row2_col6, #T_42f38_row3_col1, #T_42f38_row5_col1, #T_42f38_row5_col15, #T_42f38_row6_col2, #T_42f38_row9_col1, #T_42f38_row11_col9, #T_42f38_row14_col1, #T_42f38_row16_col2, #T_42f38_row16_col8, #T_42f38_row20_col22 {
  background-color: #688aef;
  color: #f1f1f1;
}
#T_42f38_row2_col8, #T_42f38_row2_col10, #T_42f38_row10_col3, #T_42f38_row12_col2, #T_42f38_row12_col9, #T_42f38_row12_col18, #T_42f38_row13_col11, #T_42f38_row19_col21 {
  background-color: #506bda;
  color: #f1f1f1;
}
#T_42f38_row2_col9, #T_42f38_row2_col15, #T_42f38_row8_col12, #T_42f38_row11_col1, #T_42f38_row12_col19, #T_42f38_row13_col5, #T_42f38_row17_col1, #T_42f38_row18_col21, #T_42f38_row21_col13 {
  background-color: #485fd1;
  color: #f1f1f1;
}
#T_42f38_row2_col14, #T_42f38_row14_col8, #T_42f38_row14_col21, #T_42f38_row20_col14, #T_42f38_row22_col14 {
  background-color: #3d50c3;
  color: #f1f1f1;
}
#T_42f38_row2_col16, #T_42f38_row2_col17, #T_42f38_row4_col13, #T_42f38_row4_col22, #T_42f38_row13_col10, #T_42f38_row13_col18, #T_42f38_row18_col9, #T_42f38_row18_col17 {
  background-color: #5977e3;
  color: #f1f1f1;
}
#T_42f38_row2_col20, #T_42f38_row3_col20, #T_42f38_row8_col10, #T_42f38_row14_col18, #T_42f38_row15_col11, #T_42f38_row19_col1, #T_42f38_row19_col4 {
  background-color: #6485ec;
  color: #f1f1f1;
}
#T_42f38_row2_col21, #T_42f38_row4_col10, #T_42f38_row4_col18, #T_42f38_row5_col2, #T_42f38_row9_col4, #T_42f38_row9_col14, #T_42f38_row9_col20, #T_42f38_row11_col0, #T_42f38_row11_col20, #T_42f38_row12_col13, #T_42f38_row12_col21, #T_42f38_row17_col10 {
  background-color: #5b7ae5;
  color: #f1f1f1;
}
#T_42f38_row2_col22, #T_42f38_row15_col1, #T_42f38_row19_col7, #T_42f38_row20_col6 {
  background-color: #7295f4;
  color: #f1f1f1;
}
#T_42f38_row3_col0, #T_42f38_row5_col7, #T_42f38_row16_col20, #T_42f38_row18_col0, #T_42f38_row22_col21 {
  background-color: #8badfd;
  color: #000000;
}
#T_42f38_row3_col2, #T_42f38_row3_col4, #T_42f38_row4_col1, #T_42f38_row9_col2, #T_42f38_row10_col4, #T_42f38_row11_col4, #T_42f38_row12_col20, #T_42f38_row13_col9, #T_42f38_row16_col21, #T_42f38_row19_col14, #T_42f38_row22_col16, #T_42f38_row22_col17 {
  background-color: #5673e0;
  color: #f1f1f1;
}
#T_42f38_row3_col5, #T_42f38_row17_col16 {
  background-color: #a9c6fd;
  color: #000000;
}
#T_42f38_row3_col6, #T_42f38_row6_col0, #T_42f38_row17_col19, #T_42f38_row19_col10 {
  background-color: #92b4fe;
  color: #000000;
}
#T_42f38_row3_col8, #T_42f38_row8_col3 {
  background-color: #aac7fd;
  color: #000000;
}
#T_42f38_row3_col9, #T_42f38_row12_col17, #T_42f38_row16_col14, #T_42f38_row18_col2, #T_42f38_row18_col13 {
  background-color: #4c66d6;
  color: #f1f1f1;
}
#T_42f38_row3_col12, #T_42f38_row6_col1, #T_42f38_row6_col14, #T_42f38_row11_col12, #T_42f38_row13_col6, #T_42f38_row20_col13, #T_42f38_row21_col3, #T_42f38_row21_col6 {
  background-color: #3f53c6;
  color: #f1f1f1;
}
#T_42f38_row3_col13, #T_42f38_row13_col7, #T_42f38_row13_col17, #T_42f38_row14_col19, #T_42f38_row17_col14, #T_42f38_row21_col11, #T_42f38_row22_col4 {
  background-color: #445acc;
  color: #f1f1f1;
}
#T_42f38_row4_col2, #T_42f38_row6_col5, #T_42f38_row6_col20, #T_42f38_row7_col4, #T_42f38_row7_col5, #T_42f38_row7_col11, #T_42f38_row7_col20, #T_42f38_row12_col22 {
  background-color: #7699f6;
  color: #f1f1f1;
}
#T_42f38_row4_col6, #T_42f38_row4_col7 {
  background-color: #81a4fb;
  color: #f1f1f1;
}
#T_42f38_row4_col11, #T_42f38_row11_col7, #T_42f38_row11_col18, #T_42f38_row11_col19, #T_42f38_row15_col10, #T_42f38_row16_col4 {
  background-color: #6b8df0;
  color: #f1f1f1;
}
#T_42f38_row4_col14, #T_42f38_row10_col21, #T_42f38_row11_col8, #T_42f38_row18_col22 {
  background-color: #4358cb;
  color: #f1f1f1;
}
#T_42f38_row4_col16, #T_42f38_row4_col17, #T_42f38_row6_col19, #T_42f38_row9_col7, #T_42f38_row9_col13, #T_42f38_row10_col1, #T_42f38_row10_col15, #T_42f38_row15_col5, #T_42f38_row18_col5, #T_42f38_row18_col7, #T_42f38_row19_col2, #T_42f38_row19_col3, #T_42f38_row20_col2, #T_42f38_row22_col2 {
  background-color: #6282ea;
  color: #f1f1f1;
}
#T_42f38_row5_col0 {
  background-color: #9fbfff;
  color: #000000;
}
#T_42f38_row5_col3, #T_42f38_row18_col19, #T_42f38_row19_col0 {
  background-color: #abc8fd;
  color: #000000;
}
#T_42f38_row5_col8, #T_42f38_row17_col0 {
  background-color: #b5cdfa;
  color: #000000;
}
#T_42f38_row5_col16, #T_42f38_row19_col5 {
  background-color: #6e90f2;
  color: #f1f1f1;
}
#T_42f38_row5_col18, #T_42f38_row16_col10 {
  background-color: #7a9df8;
  color: #f1f1f1;
}
#T_42f38_row5_col19, #T_42f38_row7_col2, #T_42f38_row8_col18, #T_42f38_row9_col18, #T_42f38_row16_col6 {
  background-color: #6f92f3;
  color: #f1f1f1;
}
#T_42f38_row6_col3 {
  background-color: #85a8fc;
  color: #f1f1f1;
}
#T_42f38_row6_col4, #T_42f38_row6_col17, #T_42f38_row16_col11 {
  background-color: #7da0f9;
  color: #f1f1f1;
}
#T_42f38_row6_col7 {
  background-color: #f2c9b4;
  color: #000000;
}
#T_42f38_row6_col8, #T_42f38_row15_col19 {
  background-color: #8db0fe;
  color: #000000;
}
#T_42f38_row6_col11, #T_42f38_row9_col19, #T_42f38_row19_col9, #T_42f38_row20_col7 {
  background-color: #779af7;
  color: #f1f1f1;
}
#T_42f38_row7_col0, #T_42f38_row15_col16 {
  background-color: #8fb1fe;
  color: #000000;
}
#T_42f38_row7_col3, #T_42f38_row13_col1, #T_42f38_row17_col6, #T_42f38_row18_col16 {
  background-color: #82a6fb;
  color: #f1f1f1;
}
#T_42f38_row7_col6 {
  background-color: #f2cab5;
  color: #000000;
}
#T_42f38_row7_col14, #T_42f38_row14_col0, #T_42f38_row14_col5, #T_42f38_row14_col20 {
  background-color: #3e51c5;
  color: #f1f1f1;
}
#T_42f38_row7_col16, #T_42f38_row8_col22, #T_42f38_row13_col16, #T_42f38_row17_col2, #T_42f38_row18_col3, #T_42f38_row18_col6, #T_42f38_row18_col14, #T_42f38_row19_col13, #T_42f38_row19_col22 {
  background-color: #5f7fe8;
  color: #f1f1f1;
}
#T_42f38_row7_col19, #T_42f38_row8_col2, #T_42f38_row8_col15, #T_42f38_row11_col16, #T_42f38_row16_col3, #T_42f38_row20_col4, #T_42f38_row22_col12 {
  background-color: #5e7de7;
  color: #f1f1f1;
}
#T_42f38_row8_col0 {
  background-color: #90b2fe;
  color: #000000;
}
#T_42f38_row8_col5 {
  background-color: #b2ccfb;
  color: #000000;
}
#T_42f38_row8_col7 {
  background-color: #a3c2fe;
  color: #000000;
}
#T_42f38_row8_col13, #T_42f38_row9_col12, #T_42f38_row10_col8, #T_42f38_row12_col11, #T_42f38_row13_col4, #T_42f38_row13_col12, #T_42f38_row15_col6, #T_42f38_row15_col14 {
  background-color: #5875e1;
  color: #f1f1f1;
}
#T_42f38_row9_col0, #T_42f38_row9_col15, #T_42f38_row10_col16, #T_42f38_row16_col5, #T_42f38_row17_col22 {
  background-color: #6c8ff1;
  color: #f1f1f1;
}
#T_42f38_row9_col10 {
  background-color: #f3c8b2;
  color: #000000;
}
#T_42f38_row10_col9 {
  background-color: #f1cdba;
  color: #000000;
}
#T_42f38_row10_col11, #T_42f38_row16_col18 {
  background-color: #97b8ff;
  color: #000000;
}
#T_42f38_row10_col19, #T_42f38_row17_col7 {
  background-color: #84a7fc;
  color: #f1f1f1;
}
#T_42f38_row11_col5, #T_42f38_row12_col15, #T_42f38_row14_col7, #T_42f38_row18_col12, #T_42f38_row22_col19 {
  background-color: #4055c8;
  color: #f1f1f1;
}
#T_42f38_row11_col10 {
  background-color: #88abfd;
  color: #000000;
}
#T_42f38_row12_col5, #T_42f38_row12_col8, #T_42f38_row14_col3, #T_42f38_row15_col12, #T_42f38_row20_col15, #T_42f38_row21_col15, #T_42f38_row21_col16, #T_42f38_row22_col8, #T_42f38_row22_col9 {
  background-color: #4257c9;
  color: #f1f1f1;
}
#T_42f38_row15_col18 {
  background-color: #dedcdb;
  color: #000000;
}
#T_42f38_row16_col0 {
  background-color: #bad0f8;
  color: #000000;
}
#T_42f38_row16_col15 {
  background-color: #94b6ff;
  color: #000000;
}
#T_42f38_row16_col17 {
  background-color: #afcafc;
  color: #000000;
}
#T_42f38_row16_col19, #T_42f38_row19_col16 {
  background-color: #ebd3c6;
  color: #000000;
}
#T_42f38_row17_col20 {
  background-color: #e2dad5;
  color: #000000;
}
#T_42f38_row18_col10 {
  background-color: #7ea1fa;
  color: #f1f1f1;
}
#T_42f38_row18_col15 {
  background-color: #d7dce3;
  color: #000000;
}
#T_42f38_row19_col11 {
  background-color: #89acfd;
  color: #000000;
}
#T_42f38_row19_col17 {
  background-color: #98b9ff;
  color: #000000;
}
#T_42f38_row19_col18 {
  background-color: #bcd2f7;
  color: #000000;
}
#T_42f38_row20_col17 {
  background-color: #dddcdc;
  color: #000000;
}
</style>
<table id="T_42f38">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_42f38_level0_col0" class="col_heading level0 col0" >h1n1_concern</th>
      <th id="T_42f38_level0_col1" class="col_heading level0 col1" >h1n1_knowledge</th>
      <th id="T_42f38_level0_col2" class="col_heading level0 col2" >behavioral_antiviral_meds</th>
      <th id="T_42f38_level0_col3" class="col_heading level0 col3" >behavioral_avoidance</th>
      <th id="T_42f38_level0_col4" class="col_heading level0 col4" >behavioral_face_mask</th>
      <th id="T_42f38_level0_col5" class="col_heading level0 col5" >behavioral_wash_hands</th>
      <th id="T_42f38_level0_col6" class="col_heading level0 col6" >behavioral_large_gatherings</th>
      <th id="T_42f38_level0_col7" class="col_heading level0 col7" >behavioral_outside_home</th>
      <th id="T_42f38_level0_col8" class="col_heading level0 col8" >behavioral_touch_face</th>
      <th id="T_42f38_level0_col9" class="col_heading level0 col9" >doctor_recc_h1n1</th>
      <th id="T_42f38_level0_col10" class="col_heading level0 col10" >doctor_recc_seasonal</th>
      <th id="T_42f38_level0_col11" class="col_heading level0 col11" >chronic_med_condition</th>
      <th id="T_42f38_level0_col12" class="col_heading level0 col12" >child_under_6_months</th>
      <th id="T_42f38_level0_col13" class="col_heading level0 col13" >health_worker</th>
      <th id="T_42f38_level0_col14" class="col_heading level0 col14" >health_insurance</th>
      <th id="T_42f38_level0_col15" class="col_heading level0 col15" >opinion_h1n1_vacc_effective</th>
      <th id="T_42f38_level0_col16" class="col_heading level0 col16" >opinion_h1n1_risk</th>
      <th id="T_42f38_level0_col17" class="col_heading level0 col17" >opinion_h1n1_sick_from_vacc</th>
      <th id="T_42f38_level0_col18" class="col_heading level0 col18" >opinion_seas_vacc_effective</th>
      <th id="T_42f38_level0_col19" class="col_heading level0 col19" >opinion_seas_risk</th>
      <th id="T_42f38_level0_col20" class="col_heading level0 col20" >opinion_seas_sick_from_vacc</th>
      <th id="T_42f38_level0_col21" class="col_heading level0 col21" >household_adults</th>
      <th id="T_42f38_level0_col22" class="col_heading level0 col22" >household_children</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_42f38_level0_row0" class="row_heading level0 row0" >h1n1_concern</th>
      <td id="T_42f38_row0_col0" class="data row0 col0" >1.00</td>
      <td id="T_42f38_row0_col1" class="data row0 col1" >0.06</td>
      <td id="T_42f38_row0_col2" class="data row0 col2" >0.09</td>
      <td id="T_42f38_row0_col3" class="data row0 col3" >0.23</td>
      <td id="T_42f38_row0_col4" class="data row0 col4" >0.16</td>
      <td id="T_42f38_row0_col5" class="data row0 col5" >0.29</td>
      <td id="T_42f38_row0_col6" class="data row0 col6" >0.25</td>
      <td id="T_42f38_row0_col7" class="data row0 col7" >0.25</td>
      <td id="T_42f38_row0_col8" class="data row0 col8" >0.25</td>
      <td id="T_42f38_row0_col9" class="data row0 col9" >0.14</td>
      <td id="T_42f38_row0_col10" class="data row0 col10" >0.13</td>
      <td id="T_42f38_row0_col11" class="data row0 col11" >0.09</td>
      <td id="T_42f38_row0_col12" class="data row0 col12" >0.05</td>
      <td id="T_42f38_row0_col13" class="data row0 col13" >0.03</td>
      <td id="T_42f38_row0_col14" class="data row0 col14" >-0.00</td>
      <td id="T_42f38_row0_col15" class="data row0 col15" >0.24</td>
      <td id="T_42f38_row0_col16" class="data row0 col16" >0.37</td>
      <td id="T_42f38_row0_col17" class="data row0 col17" >0.36</td>
      <td id="T_42f38_row0_col18" class="data row0 col18" >0.23</td>
      <td id="T_42f38_row0_col19" class="data row0 col19" >0.33</td>
      <td id="T_42f38_row0_col20" class="data row0 col20" >0.22</td>
      <td id="T_42f38_row0_col21" class="data row0 col21" >-0.02</td>
      <td id="T_42f38_row0_col22" class="data row0 col22" >0.05</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row1" class="row_heading level0 row1" >h1n1_knowledge</th>
      <td id="T_42f38_row1_col0" class="data row1 col0" >0.06</td>
      <td id="T_42f38_row1_col1" class="data row1 col1" >1.00</td>
      <td id="T_42f38_row1_col2" class="data row1 col2" >-0.01</td>
      <td id="T_42f38_row1_col3" class="data row1 col3" >0.09</td>
      <td id="T_42f38_row1_col4" class="data row1 col4" >0.03</td>
      <td id="T_42f38_row1_col5" class="data row1 col5" >0.09</td>
      <td id="T_42f38_row1_col6" class="data row1 col6" >-0.05</td>
      <td id="T_42f38_row1_col7" class="data row1 col7" >-0.07</td>
      <td id="T_42f38_row1_col8" class="data row1 col8" >0.09</td>
      <td id="T_42f38_row1_col9" class="data row1 col9" >0.09</td>
      <td id="T_42f38_row1_col10" class="data row1 col10" >0.07</td>
      <td id="T_42f38_row1_col11" class="data row1 col11" >-0.02</td>
      <td id="T_42f38_row1_col12" class="data row1 col12" >0.02</td>
      <td id="T_42f38_row1_col13" class="data row1 col13" >0.17</td>
      <td id="T_42f38_row1_col14" class="data row1 col14" >0.09</td>
      <td id="T_42f38_row1_col15" class="data row1 col15" >0.12</td>
      <td id="T_42f38_row1_col16" class="data row1 col16" >0.07</td>
      <td id="T_42f38_row1_col17" class="data row1 col17" >-0.02</td>
      <td id="T_42f38_row1_col18" class="data row1 col18" >0.08</td>
      <td id="T_42f38_row1_col19" class="data row1 col19" >0.08</td>
      <td id="T_42f38_row1_col20" class="data row1 col20" >-0.06</td>
      <td id="T_42f38_row1_col21" class="data row1 col21" >0.02</td>
      <td id="T_42f38_row1_col22" class="data row1 col22" >0.05</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row2" class="row_heading level0 row2" >behavioral_antiviral_meds</th>
      <td id="T_42f38_row2_col0" class="data row2 col0" >0.09</td>
      <td id="T_42f38_row2_col1" class="data row2 col1" >-0.01</td>
      <td id="T_42f38_row2_col2" class="data row2 col2" >1.00</td>
      <td id="T_42f38_row2_col3" class="data row2 col3" >0.05</td>
      <td id="T_42f38_row2_col4" class="data row2 col4" >0.15</td>
      <td id="T_42f38_row2_col5" class="data row2 col5" >0.06</td>
      <td id="T_42f38_row2_col6" class="data row2 col6" >0.11</td>
      <td id="T_42f38_row2_col7" class="data row2 col7" >0.13</td>
      <td id="T_42f38_row2_col8" class="data row2 col8" >0.07</td>
      <td id="T_42f38_row2_col9" class="data row2 col9" >0.05</td>
      <td id="T_42f38_row2_col10" class="data row2 col10" >0.03</td>
      <td id="T_42f38_row2_col11" class="data row2 col11" >0.01</td>
      <td id="T_42f38_row2_col12" class="data row2 col12" >0.03</td>
      <td id="T_42f38_row2_col13" class="data row2 col13" >0.01</td>
      <td id="T_42f38_row2_col14" class="data row2 col14" >-0.05</td>
      <td id="T_42f38_row2_col15" class="data row2 col15" >0.03</td>
      <td id="T_42f38_row2_col16" class="data row2 col16" >0.10</td>
      <td id="T_42f38_row2_col17" class="data row2 col17" >0.08</td>
      <td id="T_42f38_row2_col18" class="data row2 col18" >0.01</td>
      <td id="T_42f38_row2_col19" class="data row2 col19" >0.08</td>
      <td id="T_42f38_row2_col20" class="data row2 col20" >0.08</td>
      <td id="T_42f38_row2_col21" class="data row2 col21" >0.04</td>
      <td id="T_42f38_row2_col22" class="data row2 col22" >0.08</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row3" class="row_heading level0 row3" >behavioral_avoidance</th>
      <td id="T_42f38_row3_col0" class="data row3 col0" >0.23</td>
      <td id="T_42f38_row3_col1" class="data row3 col1" >0.09</td>
      <td id="T_42f38_row3_col2" class="data row3 col2" >0.05</td>
      <td id="T_42f38_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_42f38_row3_col4" class="data row3 col4" >0.06</td>
      <td id="T_42f38_row3_col5" class="data row3 col5" >0.34</td>
      <td id="T_42f38_row3_col6" class="data row3 col6" >0.23</td>
      <td id="T_42f38_row3_col7" class="data row3 col7" >0.22</td>
      <td id="T_42f38_row3_col8" class="data row3 col8" >0.33</td>
      <td id="T_42f38_row3_col9" class="data row3 col9" >0.07</td>
      <td id="T_42f38_row3_col10" class="data row3 col10" >0.07</td>
      <td id="T_42f38_row3_col11" class="data row3 col11" >0.04</td>
      <td id="T_42f38_row3_col12" class="data row3 col12" >-0.00</td>
      <td id="T_42f38_row3_col13" class="data row3 col13" >0.00</td>
      <td id="T_42f38_row3_col14" class="data row3 col14" >0.02</td>
      <td id="T_42f38_row3_col15" class="data row3 col15" >0.11</td>
      <td id="T_42f38_row3_col16" class="data row3 col16" >0.12</td>
      <td id="T_42f38_row3_col17" class="data row3 col17" >0.13</td>
      <td id="T_42f38_row3_col18" class="data row3 col18" >0.12</td>
      <td id="T_42f38_row3_col19" class="data row3 col19" >0.13</td>
      <td id="T_42f38_row3_col20" class="data row3 col20" >0.08</td>
      <td id="T_42f38_row3_col21" class="data row3 col21" >0.02</td>
      <td id="T_42f38_row3_col22" class="data row3 col22" >0.04</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row4" class="row_heading level0 row4" >behavioral_face_mask</th>
      <td id="T_42f38_row4_col0" class="data row4 col0" >0.16</td>
      <td id="T_42f38_row4_col1" class="data row4 col1" >0.03</td>
      <td id="T_42f38_row4_col2" class="data row4 col2" >0.15</td>
      <td id="T_42f38_row4_col3" class="data row4 col3" >0.06</td>
      <td id="T_42f38_row4_col4" class="data row4 col4" >1.00</td>
      <td id="T_42f38_row4_col5" class="data row4 col5" >0.08</td>
      <td id="T_42f38_row4_col6" class="data row4 col6" >0.18</td>
      <td id="T_42f38_row4_col7" class="data row4 col7" >0.16</td>
      <td id="T_42f38_row4_col8" class="data row4 col8" >0.10</td>
      <td id="T_42f38_row4_col9" class="data row4 col9" >0.08</td>
      <td id="T_42f38_row4_col10" class="data row4 col10" >0.07</td>
      <td id="T_42f38_row4_col11" class="data row4 col11" >0.07</td>
      <td id="T_42f38_row4_col12" class="data row4 col12" >0.04</td>
      <td id="T_42f38_row4_col13" class="data row4 col13" >0.07</td>
      <td id="T_42f38_row4_col14" class="data row4 col14" >-0.03</td>
      <td id="T_42f38_row4_col15" class="data row4 col15" >0.04</td>
      <td id="T_42f38_row4_col16" class="data row4 col16" >0.13</td>
      <td id="T_42f38_row4_col17" class="data row4 col17" >0.11</td>
      <td id="T_42f38_row4_col18" class="data row4 col18" >0.04</td>
      <td id="T_42f38_row4_col19" class="data row4 col19" >0.11</td>
      <td id="T_42f38_row4_col20" class="data row4 col20" >0.09</td>
      <td id="T_42f38_row4_col21" class="data row4 col21" >0.01</td>
      <td id="T_42f38_row4_col22" class="data row4 col22" >0.01</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row5" class="row_heading level0 row5" >behavioral_wash_hands</th>
      <td id="T_42f38_row5_col0" class="data row5 col0" >0.29</td>
      <td id="T_42f38_row5_col1" class="data row5 col1" >0.09</td>
      <td id="T_42f38_row5_col2" class="data row5 col2" >0.06</td>
      <td id="T_42f38_row5_col3" class="data row5 col3" >0.34</td>
      <td id="T_42f38_row5_col4" class="data row5 col4" >0.08</td>
      <td id="T_42f38_row5_col5" class="data row5 col5" >1.00</td>
      <td id="T_42f38_row5_col6" class="data row5 col6" >0.19</td>
      <td id="T_42f38_row5_col7" class="data row5 col7" >0.19</td>
      <td id="T_42f38_row5_col8" class="data row5 col8" >0.36</td>
      <td id="T_42f38_row5_col9" class="data row5 col9" >0.08</td>
      <td id="T_42f38_row5_col10" class="data row5 col10" >0.10</td>
      <td id="T_42f38_row5_col11" class="data row5 col11" >0.03</td>
      <td id="T_42f38_row5_col12" class="data row5 col12" >0.04</td>
      <td id="T_42f38_row5_col13" class="data row5 col13" >0.05</td>
      <td id="T_42f38_row5_col14" class="data row5 col14" >0.02</td>
      <td id="T_42f38_row5_col15" class="data row5 col15" >0.14</td>
      <td id="T_42f38_row5_col16" class="data row5 col16" >0.17</td>
      <td id="T_42f38_row5_col17" class="data row5 col17" >0.15</td>
      <td id="T_42f38_row5_col18" class="data row5 col18" >0.14</td>
      <td id="T_42f38_row5_col19" class="data row5 col19" >0.17</td>
      <td id="T_42f38_row5_col20" class="data row5 col20" >0.09</td>
      <td id="T_42f38_row5_col21" class="data row5 col21" >0.01</td>
      <td id="T_42f38_row5_col22" class="data row5 col22" >0.05</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row6" class="row_heading level0 row6" >behavioral_large_gatherings</th>
      <td id="T_42f38_row6_col0" class="data row6 col0" >0.25</td>
      <td id="T_42f38_row6_col1" class="data row6 col1" >-0.05</td>
      <td id="T_42f38_row6_col2" class="data row6 col2" >0.11</td>
      <td id="T_42f38_row6_col3" class="data row6 col3" >0.23</td>
      <td id="T_42f38_row6_col4" class="data row6 col4" >0.18</td>
      <td id="T_42f38_row6_col5" class="data row6 col5" >0.19</td>
      <td id="T_42f38_row6_col6" class="data row6 col6" >1.00</td>
      <td id="T_42f38_row6_col7" class="data row6 col7" >0.58</td>
      <td id="T_42f38_row6_col8" class="data row6 col8" >0.25</td>
      <td id="T_42f38_row6_col9" class="data row6 col9" >0.08</td>
      <td id="T_42f38_row6_col10" class="data row6 col10" >0.09</td>
      <td id="T_42f38_row6_col11" class="data row6 col11" >0.10</td>
      <td id="T_42f38_row6_col12" class="data row6 col12" >0.02</td>
      <td id="T_42f38_row6_col13" class="data row6 col13" >-0.03</td>
      <td id="T_42f38_row6_col14" class="data row6 col14" >-0.04</td>
      <td id="T_42f38_row6_col15" class="data row6 col15" >0.05</td>
      <td id="T_42f38_row6_col16" class="data row6 col16" >0.13</td>
      <td id="T_42f38_row6_col17" class="data row6 col17" >0.18</td>
      <td id="T_42f38_row6_col18" class="data row6 col18" >0.08</td>
      <td id="T_42f38_row6_col19" class="data row6 col19" >0.13</td>
      <td id="T_42f38_row6_col20" class="data row6 col20" >0.13</td>
      <td id="T_42f38_row6_col21" class="data row6 col21" >-0.03</td>
      <td id="T_42f38_row6_col22" class="data row6 col22" >-0.01</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row7" class="row_heading level0 row7" >behavioral_outside_home</th>
      <td id="T_42f38_row7_col0" class="data row7 col0" >0.25</td>
      <td id="T_42f38_row7_col1" class="data row7 col1" >-0.07</td>
      <td id="T_42f38_row7_col2" class="data row7 col2" >0.13</td>
      <td id="T_42f38_row7_col3" class="data row7 col3" >0.22</td>
      <td id="T_42f38_row7_col4" class="data row7 col4" >0.16</td>
      <td id="T_42f38_row7_col5" class="data row7 col5" >0.19</td>
      <td id="T_42f38_row7_col6" class="data row7 col6" >0.58</td>
      <td id="T_42f38_row7_col7" class="data row7 col7" >1.00</td>
      <td id="T_42f38_row7_col8" class="data row7 col8" >0.27</td>
      <td id="T_42f38_row7_col9" class="data row7 col9" >0.07</td>
      <td id="T_42f38_row7_col10" class="data row7 col10" >0.08</td>
      <td id="T_42f38_row7_col11" class="data row7 col11" >0.10</td>
      <td id="T_42f38_row7_col12" class="data row7 col12" >0.02</td>
      <td id="T_42f38_row7_col13" class="data row7 col13" >-0.03</td>
      <td id="T_42f38_row7_col14" class="data row7 col14" >-0.04</td>
      <td id="T_42f38_row7_col15" class="data row7 col15" >0.05</td>
      <td id="T_42f38_row7_col16" class="data row7 col16" >0.12</td>
      <td id="T_42f38_row7_col17" class="data row7 col17" >0.17</td>
      <td id="T_42f38_row7_col18" class="data row7 col18" >0.07</td>
      <td id="T_42f38_row7_col19" class="data row7 col19" >0.12</td>
      <td id="T_42f38_row7_col20" class="data row7 col20" >0.14</td>
      <td id="T_42f38_row7_col21" class="data row7 col21" >-0.03</td>
      <td id="T_42f38_row7_col22" class="data row7 col22" >-0.01</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row8" class="row_heading level0 row8" >behavioral_touch_face</th>
      <td id="T_42f38_row8_col0" class="data row8 col0" >0.25</td>
      <td id="T_42f38_row8_col1" class="data row8 col1" >0.09</td>
      <td id="T_42f38_row8_col2" class="data row8 col2" >0.07</td>
      <td id="T_42f38_row8_col3" class="data row8 col3" >0.33</td>
      <td id="T_42f38_row8_col4" class="data row8 col4" >0.10</td>
      <td id="T_42f38_row8_col5" class="data row8 col5" >0.36</td>
      <td id="T_42f38_row8_col6" class="data row8 col6" >0.25</td>
      <td id="T_42f38_row8_col7" class="data row8 col7" >0.27</td>
      <td id="T_42f38_row8_col8" class="data row8 col8" >1.00</td>
      <td id="T_42f38_row8_col9" class="data row8 col9" >0.08</td>
      <td id="T_42f38_row8_col10" class="data row8 col10" >0.10</td>
      <td id="T_42f38_row8_col11" class="data row8 col11" >0.03</td>
      <td id="T_42f38_row8_col12" class="data row8 col12" >0.03</td>
      <td id="T_42f38_row8_col13" class="data row8 col13" >0.07</td>
      <td id="T_42f38_row8_col14" class="data row8 col14" >0.01</td>
      <td id="T_42f38_row8_col15" class="data row8 col15" >0.10</td>
      <td id="T_42f38_row8_col16" class="data row8 col16" >0.14</td>
      <td id="T_42f38_row8_col17" class="data row8 col17" >0.13</td>
      <td id="T_42f38_row8_col18" class="data row8 col18" >0.10</td>
      <td id="T_42f38_row8_col19" class="data row8 col19" >0.14</td>
      <td id="T_42f38_row8_col20" class="data row8 col20" >0.09</td>
      <td id="T_42f38_row8_col21" class="data row8 col21" >-0.00</td>
      <td id="T_42f38_row8_col22" class="data row8 col22" >0.02</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row9" class="row_heading level0 row9" >doctor_recc_h1n1</th>
      <td id="T_42f38_row9_col0" class="data row9 col0" >0.14</td>
      <td id="T_42f38_row9_col1" class="data row9 col1" >0.09</td>
      <td id="T_42f38_row9_col2" class="data row9 col2" >0.05</td>
      <td id="T_42f38_row9_col3" class="data row9 col3" >0.07</td>
      <td id="T_42f38_row9_col4" class="data row9 col4" >0.08</td>
      <td id="T_42f38_row9_col5" class="data row9 col5" >0.08</td>
      <td id="T_42f38_row9_col6" class="data row9 col6" >0.08</td>
      <td id="T_42f38_row9_col7" class="data row9 col7" >0.07</td>
      <td id="T_42f38_row9_col8" class="data row9 col8" >0.08</td>
      <td id="T_42f38_row9_col9" class="data row9 col9" >1.00</td>
      <td id="T_42f38_row9_col10" class="data row9 col10" >0.59</td>
      <td id="T_42f38_row9_col11" class="data row9 col11" >0.15</td>
      <td id="T_42f38_row9_col12" class="data row9 col12" >0.08</td>
      <td id="T_42f38_row9_col13" class="data row9 col13" >0.10</td>
      <td id="T_42f38_row9_col14" class="data row9 col14" >0.05</td>
      <td id="T_42f38_row9_col15" class="data row9 col15" >0.15</td>
      <td id="T_42f38_row9_col16" class="data row9 col16" >0.25</td>
      <td id="T_42f38_row9_col17" class="data row9 col17" >0.11</td>
      <td id="T_42f38_row9_col18" class="data row9 col18" >0.10</td>
      <td id="T_42f38_row9_col19" class="data row9 col19" >0.19</td>
      <td id="T_42f38_row9_col20" class="data row9 col20" >0.05</td>
      <td id="T_42f38_row9_col21" class="data row9 col21" >0.00</td>
      <td id="T_42f38_row9_col22" class="data row9 col22" >0.03</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row10" class="row_heading level0 row10" >doctor_recc_seasonal</th>
      <td id="T_42f38_row10_col0" class="data row10 col0" >0.13</td>
      <td id="T_42f38_row10_col1" class="data row10 col1" >0.07</td>
      <td id="T_42f38_row10_col2" class="data row10 col2" >0.03</td>
      <td id="T_42f38_row10_col3" class="data row10 col3" >0.07</td>
      <td id="T_42f38_row10_col4" class="data row10 col4" >0.07</td>
      <td id="T_42f38_row10_col5" class="data row10 col5" >0.10</td>
      <td id="T_42f38_row10_col6" class="data row10 col6" >0.09</td>
      <td id="T_42f38_row10_col7" class="data row10 col7" >0.08</td>
      <td id="T_42f38_row10_col8" class="data row10 col8" >0.10</td>
      <td id="T_42f38_row10_col9" class="data row10 col9" >0.59</td>
      <td id="T_42f38_row10_col10" class="data row10 col10" >1.00</td>
      <td id="T_42f38_row10_col11" class="data row10 col11" >0.20</td>
      <td id="T_42f38_row10_col12" class="data row10 col12" >0.04</td>
      <td id="T_42f38_row10_col13" class="data row10 col13" >0.06</td>
      <td id="T_42f38_row10_col14" class="data row10 col14" >0.09</td>
      <td id="T_42f38_row10_col15" class="data row10 col15" >0.11</td>
      <td id="T_42f38_row10_col16" class="data row10 col16" >0.16</td>
      <td id="T_42f38_row10_col17" class="data row10 col17" >0.06</td>
      <td id="T_42f38_row10_col18" class="data row10 col18" >0.17</td>
      <td id="T_42f38_row10_col19" class="data row10 col19" >0.23</td>
      <td id="T_42f38_row10_col20" class="data row10 col20" >0.02</td>
      <td id="T_42f38_row10_col21" class="data row10 col21" >-0.04</td>
      <td id="T_42f38_row10_col22" class="data row10 col22" >-0.05</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row11" class="row_heading level0 row11" >chronic_med_condition</th>
      <td id="T_42f38_row11_col0" class="data row11 col0" >0.09</td>
      <td id="T_42f38_row11_col1" class="data row11 col1" >-0.02</td>
      <td id="T_42f38_row11_col2" class="data row11 col2" >0.01</td>
      <td id="T_42f38_row11_col3" class="data row11 col3" >0.04</td>
      <td id="T_42f38_row11_col4" class="data row11 col4" >0.07</td>
      <td id="T_42f38_row11_col5" class="data row11 col5" >0.03</td>
      <td id="T_42f38_row11_col6" class="data row11 col6" >0.10</td>
      <td id="T_42f38_row11_col7" class="data row11 col7" >0.10</td>
      <td id="T_42f38_row11_col8" class="data row11 col8" >0.03</td>
      <td id="T_42f38_row11_col9" class="data row11 col9" >0.15</td>
      <td id="T_42f38_row11_col10" class="data row11 col10" >0.20</td>
      <td id="T_42f38_row11_col11" class="data row11 col11" >1.00</td>
      <td id="T_42f38_row11_col12" class="data row11 col12" >-0.00</td>
      <td id="T_42f38_row11_col13" class="data row11 col13" >-0.03</td>
      <td id="T_42f38_row11_col14" class="data row11 col14" >0.05</td>
      <td id="T_42f38_row11_col15" class="data row11 col15" >0.04</td>
      <td id="T_42f38_row11_col16" class="data row11 col16" >0.12</td>
      <td id="T_42f38_row11_col17" class="data row11 col17" >0.08</td>
      <td id="T_42f38_row11_col18" class="data row11 col18" >0.09</td>
      <td id="T_42f38_row11_col19" class="data row11 col19" >0.16</td>
      <td id="T_42f38_row11_col20" class="data row11 col20" >0.05</td>
      <td id="T_42f38_row11_col21" class="data row11 col21" >-0.07</td>
      <td id="T_42f38_row11_col22" class="data row11 col22" >-0.11</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row12" class="row_heading level0 row12" >child_under_6_months</th>
      <td id="T_42f38_row12_col0" class="data row12 col0" >0.05</td>
      <td id="T_42f38_row12_col1" class="data row12 col1" >0.02</td>
      <td id="T_42f38_row12_col2" class="data row12 col2" >0.03</td>
      <td id="T_42f38_row12_col3" class="data row12 col3" >-0.00</td>
      <td id="T_42f38_row12_col4" class="data row12 col4" >0.04</td>
      <td id="T_42f38_row12_col5" class="data row12 col5" >0.04</td>
      <td id="T_42f38_row12_col6" class="data row12 col6" >0.02</td>
      <td id="T_42f38_row12_col7" class="data row12 col7" >0.02</td>
      <td id="T_42f38_row12_col8" class="data row12 col8" >0.03</td>
      <td id="T_42f38_row12_col9" class="data row12 col9" >0.08</td>
      <td id="T_42f38_row12_col10" class="data row12 col10" >0.04</td>
      <td id="T_42f38_row12_col11" class="data row12 col11" >-0.00</td>
      <td id="T_42f38_row12_col12" class="data row12 col12" >1.00</td>
      <td id="T_42f38_row12_col13" class="data row12 col13" >0.08</td>
      <td id="T_42f38_row12_col14" class="data row12 col14" >-0.02</td>
      <td id="T_42f38_row12_col15" class="data row12 col15" >0.01</td>
      <td id="T_42f38_row12_col16" class="data row12 col16" >0.09</td>
      <td id="T_42f38_row12_col17" class="data row12 col17" >0.04</td>
      <td id="T_42f38_row12_col18" class="data row12 col18" >0.00</td>
      <td id="T_42f38_row12_col19" class="data row12 col19" >0.05</td>
      <td id="T_42f38_row12_col20" class="data row12 col20" >0.04</td>
      <td id="T_42f38_row12_col21" class="data row12 col21" >0.04</td>
      <td id="T_42f38_row12_col22" class="data row12 col22" >0.10</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row13" class="row_heading level0 row13" >health_worker</th>
      <td id="T_42f38_row13_col0" class="data row13 col0" >0.03</td>
      <td id="T_42f38_row13_col1" class="data row13 col1" >0.17</td>
      <td id="T_42f38_row13_col2" class="data row13 col2" >0.01</td>
      <td id="T_42f38_row13_col3" class="data row13 col3" >0.00</td>
      <td id="T_42f38_row13_col4" class="data row13 col4" >0.07</td>
      <td id="T_42f38_row13_col5" class="data row13 col5" >0.05</td>
      <td id="T_42f38_row13_col6" class="data row13 col6" >-0.03</td>
      <td id="T_42f38_row13_col7" class="data row13 col7" >-0.03</td>
      <td id="T_42f38_row13_col8" class="data row13 col8" >0.07</td>
      <td id="T_42f38_row13_col9" class="data row13 col9" >0.10</td>
      <td id="T_42f38_row13_col10" class="data row13 col10" >0.06</td>
      <td id="T_42f38_row13_col11" class="data row13 col11" >-0.03</td>
      <td id="T_42f38_row13_col12" class="data row13 col12" >0.08</td>
      <td id="T_42f38_row13_col13" class="data row13 col13" >1.00</td>
      <td id="T_42f38_row13_col14" class="data row13 col14" >0.03</td>
      <td id="T_42f38_row13_col15" class="data row13 col15" >0.05</td>
      <td id="T_42f38_row13_col16" class="data row13 col16" >0.12</td>
      <td id="T_42f38_row13_col17" class="data row13 col17" >0.01</td>
      <td id="T_42f38_row13_col18" class="data row13 col18" >0.03</td>
      <td id="T_42f38_row13_col19" class="data row13 col19" >0.09</td>
      <td id="T_42f38_row13_col20" class="data row13 col20" >-0.02</td>
      <td id="T_42f38_row13_col21" class="data row13 col21" >0.01</td>
      <td id="T_42f38_row13_col22" class="data row13 col22" >0.04</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row14" class="row_heading level0 row14" >health_insurance</th>
      <td id="T_42f38_row14_col0" class="data row14 col0" >-0.00</td>
      <td id="T_42f38_row14_col1" class="data row14 col1" >0.09</td>
      <td id="T_42f38_row14_col2" class="data row14 col2" >-0.05</td>
      <td id="T_42f38_row14_col3" class="data row14 col3" >0.02</td>
      <td id="T_42f38_row14_col4" class="data row14 col4" >-0.03</td>
      <td id="T_42f38_row14_col5" class="data row14 col5" >0.02</td>
      <td id="T_42f38_row14_col6" class="data row14 col6" >-0.04</td>
      <td id="T_42f38_row14_col7" class="data row14 col7" >-0.04</td>
      <td id="T_42f38_row14_col8" class="data row14 col8" >0.01</td>
      <td id="T_42f38_row14_col9" class="data row14 col9" >0.05</td>
      <td id="T_42f38_row14_col10" class="data row14 col10" >0.09</td>
      <td id="T_42f38_row14_col11" class="data row14 col11" >0.05</td>
      <td id="T_42f38_row14_col12" class="data row14 col12" >-0.02</td>
      <td id="T_42f38_row14_col13" class="data row14 col13" >0.03</td>
      <td id="T_42f38_row14_col14" class="data row14 col14" >1.00</td>
      <td id="T_42f38_row14_col15" class="data row14 col15" >0.04</td>
      <td id="T_42f38_row14_col16" class="data row14 col16" >0.00</td>
      <td id="T_42f38_row14_col17" class="data row14 col17" >-0.02</td>
      <td id="T_42f38_row14_col18" class="data row14 col18" >0.07</td>
      <td id="T_42f38_row14_col19" class="data row14 col19" >0.04</td>
      <td id="T_42f38_row14_col20" class="data row14 col20" >-0.05</td>
      <td id="T_42f38_row14_col21" class="data row14 col21" >-0.06</td>
      <td id="T_42f38_row14_col22" class="data row14 col22" >-0.05</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row15" class="row_heading level0 row15" >opinion_h1n1_vacc_effective</th>
      <td id="T_42f38_row15_col0" class="data row15 col0" >0.24</td>
      <td id="T_42f38_row15_col1" class="data row15 col1" >0.12</td>
      <td id="T_42f38_row15_col2" class="data row15 col2" >0.03</td>
      <td id="T_42f38_row15_col3" class="data row15 col3" >0.11</td>
      <td id="T_42f38_row15_col4" class="data row15 col4" >0.04</td>
      <td id="T_42f38_row15_col5" class="data row15 col5" >0.14</td>
      <td id="T_42f38_row15_col6" class="data row15 col6" >0.05</td>
      <td id="T_42f38_row15_col7" class="data row15 col7" >0.05</td>
      <td id="T_42f38_row15_col8" class="data row15 col8" >0.10</td>
      <td id="T_42f38_row15_col9" class="data row15 col9" >0.15</td>
      <td id="T_42f38_row15_col10" class="data row15 col10" >0.11</td>
      <td id="T_42f38_row15_col11" class="data row15 col11" >0.04</td>
      <td id="T_42f38_row15_col12" class="data row15 col12" >0.01</td>
      <td id="T_42f38_row15_col13" class="data row15 col13" >0.05</td>
      <td id="T_42f38_row15_col14" class="data row15 col14" >0.04</td>
      <td id="T_42f38_row15_col15" class="data row15 col15" >1.00</td>
      <td id="T_42f38_row15_col16" class="data row15 col16" >0.26</td>
      <td id="T_42f38_row15_col17" class="data row15 col17" >0.06</td>
      <td id="T_42f38_row15_col18" class="data row15 col18" >0.47</td>
      <td id="T_42f38_row15_col19" class="data row15 col19" >0.26</td>
      <td id="T_42f38_row15_col20" class="data row15 col20" >0.01</td>
      <td id="T_42f38_row15_col21" class="data row15 col21" >0.01</td>
      <td id="T_42f38_row15_col22" class="data row15 col22" >-0.02</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row16" class="row_heading level0 row16" >opinion_h1n1_risk</th>
      <td id="T_42f38_row16_col0" class="data row16 col0" >0.37</td>
      <td id="T_42f38_row16_col1" class="data row16 col1" >0.07</td>
      <td id="T_42f38_row16_col2" class="data row16 col2" >0.10</td>
      <td id="T_42f38_row16_col3" class="data row16 col3" >0.12</td>
      <td id="T_42f38_row16_col4" class="data row16 col4" >0.13</td>
      <td id="T_42f38_row16_col5" class="data row16 col5" >0.17</td>
      <td id="T_42f38_row16_col6" class="data row16 col6" >0.13</td>
      <td id="T_42f38_row16_col7" class="data row16 col7" >0.12</td>
      <td id="T_42f38_row16_col8" class="data row16 col8" >0.14</td>
      <td id="T_42f38_row16_col9" class="data row16 col9" >0.25</td>
      <td id="T_42f38_row16_col10" class="data row16 col10" >0.16</td>
      <td id="T_42f38_row16_col11" class="data row16 col11" >0.12</td>
      <td id="T_42f38_row16_col12" class="data row16 col12" >0.09</td>
      <td id="T_42f38_row16_col13" class="data row16 col13" >0.12</td>
      <td id="T_42f38_row16_col14" class="data row16 col14" >0.00</td>
      <td id="T_42f38_row16_col15" class="data row16 col15" >0.26</td>
      <td id="T_42f38_row16_col16" class="data row16 col16" >1.00</td>
      <td id="T_42f38_row16_col17" class="data row16 col17" >0.33</td>
      <td id="T_42f38_row16_col18" class="data row16 col18" >0.22</td>
      <td id="T_42f38_row16_col19" class="data row16 col19" >0.56</td>
      <td id="T_42f38_row16_col20" class="data row16 col20" >0.20</td>
      <td id="T_42f38_row16_col21" class="data row16 col21" >0.03</td>
      <td id="T_42f38_row16_col22" class="data row16 col22" >0.09</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row17" class="row_heading level0 row17" >opinion_h1n1_sick_from_vacc</th>
      <td id="T_42f38_row17_col0" class="data row17 col0" >0.36</td>
      <td id="T_42f38_row17_col1" class="data row17 col1" >-0.02</td>
      <td id="T_42f38_row17_col2" class="data row17 col2" >0.08</td>
      <td id="T_42f38_row17_col3" class="data row17 col3" >0.13</td>
      <td id="T_42f38_row17_col4" class="data row17 col4" >0.11</td>
      <td id="T_42f38_row17_col5" class="data row17 col5" >0.15</td>
      <td id="T_42f38_row17_col6" class="data row17 col6" >0.18</td>
      <td id="T_42f38_row17_col7" class="data row17 col7" >0.17</td>
      <td id="T_42f38_row17_col8" class="data row17 col8" >0.13</td>
      <td id="T_42f38_row17_col9" class="data row17 col9" >0.11</td>
      <td id="T_42f38_row17_col10" class="data row17 col10" >0.06</td>
      <td id="T_42f38_row17_col11" class="data row17 col11" >0.08</td>
      <td id="T_42f38_row17_col12" class="data row17 col12" >0.04</td>
      <td id="T_42f38_row17_col13" class="data row17 col13" >0.01</td>
      <td id="T_42f38_row17_col14" class="data row17 col14" >-0.02</td>
      <td id="T_42f38_row17_col15" class="data row17 col15" >0.06</td>
      <td id="T_42f38_row17_col16" class="data row17 col16" >0.33</td>
      <td id="T_42f38_row17_col17" class="data row17 col17" >1.00</td>
      <td id="T_42f38_row17_col18" class="data row17 col18" >0.08</td>
      <td id="T_42f38_row17_col19" class="data row17 col19" >0.27</td>
      <td id="T_42f38_row17_col20" class="data row17 col20" >0.49</td>
      <td id="T_42f38_row17_col21" class="data row17 col21" >0.01</td>
      <td id="T_42f38_row17_col22" class="data row17 col22" >0.07</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row18" class="row_heading level0 row18" >opinion_seas_vacc_effective</th>
      <td id="T_42f38_row18_col0" class="data row18 col0" >0.23</td>
      <td id="T_42f38_row18_col1" class="data row18 col1" >0.08</td>
      <td id="T_42f38_row18_col2" class="data row18 col2" >0.01</td>
      <td id="T_42f38_row18_col3" class="data row18 col3" >0.12</td>
      <td id="T_42f38_row18_col4" class="data row18 col4" >0.04</td>
      <td id="T_42f38_row18_col5" class="data row18 col5" >0.14</td>
      <td id="T_42f38_row18_col6" class="data row18 col6" >0.08</td>
      <td id="T_42f38_row18_col7" class="data row18 col7" >0.07</td>
      <td id="T_42f38_row18_col8" class="data row18 col8" >0.10</td>
      <td id="T_42f38_row18_col9" class="data row18 col9" >0.10</td>
      <td id="T_42f38_row18_col10" class="data row18 col10" >0.17</td>
      <td id="T_42f38_row18_col11" class="data row18 col11" >0.09</td>
      <td id="T_42f38_row18_col12" class="data row18 col12" >0.00</td>
      <td id="T_42f38_row18_col13" class="data row18 col13" >0.03</td>
      <td id="T_42f38_row18_col14" class="data row18 col14" >0.07</td>
      <td id="T_42f38_row18_col15" class="data row18 col15" >0.47</td>
      <td id="T_42f38_row18_col16" class="data row18 col16" >0.22</td>
      <td id="T_42f38_row18_col17" class="data row18 col17" >0.08</td>
      <td id="T_42f38_row18_col18" class="data row18 col18" >1.00</td>
      <td id="T_42f38_row18_col19" class="data row18 col19" >0.34</td>
      <td id="T_42f38_row18_col20" class="data row18 col20" >-0.02</td>
      <td id="T_42f38_row18_col21" class="data row18 col21" >-0.02</td>
      <td id="T_42f38_row18_col22" class="data row18 col22" >-0.08</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row19" class="row_heading level0 row19" >opinion_seas_risk</th>
      <td id="T_42f38_row19_col0" class="data row19 col0" >0.33</td>
      <td id="T_42f38_row19_col1" class="data row19 col1" >0.08</td>
      <td id="T_42f38_row19_col2" class="data row19 col2" >0.08</td>
      <td id="T_42f38_row19_col3" class="data row19 col3" >0.13</td>
      <td id="T_42f38_row19_col4" class="data row19 col4" >0.11</td>
      <td id="T_42f38_row19_col5" class="data row19 col5" >0.17</td>
      <td id="T_42f38_row19_col6" class="data row19 col6" >0.13</td>
      <td id="T_42f38_row19_col7" class="data row19 col7" >0.12</td>
      <td id="T_42f38_row19_col8" class="data row19 col8" >0.14</td>
      <td id="T_42f38_row19_col9" class="data row19 col9" >0.19</td>
      <td id="T_42f38_row19_col10" class="data row19 col10" >0.23</td>
      <td id="T_42f38_row19_col11" class="data row19 col11" >0.16</td>
      <td id="T_42f38_row19_col12" class="data row19 col12" >0.05</td>
      <td id="T_42f38_row19_col13" class="data row19 col13" >0.09</td>
      <td id="T_42f38_row19_col14" class="data row19 col14" >0.04</td>
      <td id="T_42f38_row19_col15" class="data row19 col15" >0.26</td>
      <td id="T_42f38_row19_col16" class="data row19 col16" >0.56</td>
      <td id="T_42f38_row19_col17" class="data row19 col17" >0.27</td>
      <td id="T_42f38_row19_col18" class="data row19 col18" >0.34</td>
      <td id="T_42f38_row19_col19" class="data row19 col19" >1.00</td>
      <td id="T_42f38_row19_col20" class="data row19 col20" >0.20</td>
      <td id="T_42f38_row19_col21" class="data row19 col21" >0.01</td>
      <td id="T_42f38_row19_col22" class="data row19 col22" >0.03</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row20" class="row_heading level0 row20" >opinion_seas_sick_from_vacc</th>
      <td id="T_42f38_row20_col0" class="data row20 col0" >0.22</td>
      <td id="T_42f38_row20_col1" class="data row20 col1" >-0.06</td>
      <td id="T_42f38_row20_col2" class="data row20 col2" >0.08</td>
      <td id="T_42f38_row20_col3" class="data row20 col3" >0.08</td>
      <td id="T_42f38_row20_col4" class="data row20 col4" >0.09</td>
      <td id="T_42f38_row20_col5" class="data row20 col5" >0.09</td>
      <td id="T_42f38_row20_col6" class="data row20 col6" >0.13</td>
      <td id="T_42f38_row20_col7" class="data row20 col7" >0.14</td>
      <td id="T_42f38_row20_col8" class="data row20 col8" >0.09</td>
      <td id="T_42f38_row20_col9" class="data row20 col9" >0.05</td>
      <td id="T_42f38_row20_col10" class="data row20 col10" >0.02</td>
      <td id="T_42f38_row20_col11" class="data row20 col11" >0.05</td>
      <td id="T_42f38_row20_col12" class="data row20 col12" >0.04</td>
      <td id="T_42f38_row20_col13" class="data row20 col13" >-0.02</td>
      <td id="T_42f38_row20_col14" class="data row20 col14" >-0.05</td>
      <td id="T_42f38_row20_col15" class="data row20 col15" >0.01</td>
      <td id="T_42f38_row20_col16" class="data row20 col16" >0.20</td>
      <td id="T_42f38_row20_col17" class="data row20 col17" >0.49</td>
      <td id="T_42f38_row20_col18" class="data row20 col18" >-0.02</td>
      <td id="T_42f38_row20_col19" class="data row20 col19" >0.20</td>
      <td id="T_42f38_row20_col20" class="data row20 col20" >1.00</td>
      <td id="T_42f38_row20_col21" class="data row20 col21" >0.02</td>
      <td id="T_42f38_row20_col22" class="data row20 col22" >0.06</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row21" class="row_heading level0 row21" >household_adults</th>
      <td id="T_42f38_row21_col0" class="data row21 col0" >-0.02</td>
      <td id="T_42f38_row21_col1" class="data row21 col1" >0.02</td>
      <td id="T_42f38_row21_col2" class="data row21 col2" >0.04</td>
      <td id="T_42f38_row21_col3" class="data row21 col3" >0.02</td>
      <td id="T_42f38_row21_col4" class="data row21 col4" >0.01</td>
      <td id="T_42f38_row21_col5" class="data row21 col5" >0.01</td>
      <td id="T_42f38_row21_col6" class="data row21 col6" >-0.03</td>
      <td id="T_42f38_row21_col7" class="data row21 col7" >-0.03</td>
      <td id="T_42f38_row21_col8" class="data row21 col8" >-0.00</td>
      <td id="T_42f38_row21_col9" class="data row21 col9" >0.00</td>
      <td id="T_42f38_row21_col10" class="data row21 col10" >-0.04</td>
      <td id="T_42f38_row21_col11" class="data row21 col11" >-0.07</td>
      <td id="T_42f38_row21_col12" class="data row21 col12" >0.04</td>
      <td id="T_42f38_row21_col13" class="data row21 col13" >0.01</td>
      <td id="T_42f38_row21_col14" class="data row21 col14" >-0.06</td>
      <td id="T_42f38_row21_col15" class="data row21 col15" >0.01</td>
      <td id="T_42f38_row21_col16" class="data row21 col16" >0.03</td>
      <td id="T_42f38_row21_col17" class="data row21 col17" >0.01</td>
      <td id="T_42f38_row21_col18" class="data row21 col18" >-0.02</td>
      <td id="T_42f38_row21_col19" class="data row21 col19" >0.01</td>
      <td id="T_42f38_row21_col20" class="data row21 col20" >0.02</td>
      <td id="T_42f38_row21_col21" class="data row21 col21" >1.00</td>
      <td id="T_42f38_row21_col22" class="data row21 col22" >0.19</td>
    </tr>
    <tr>
      <th id="T_42f38_level0_row22" class="row_heading level0 row22" >household_children</th>
      <td id="T_42f38_row22_col0" class="data row22 col0" >0.05</td>
      <td id="T_42f38_row22_col1" class="data row22 col1" >0.05</td>
      <td id="T_42f38_row22_col2" class="data row22 col2" >0.08</td>
      <td id="T_42f38_row22_col3" class="data row22 col3" >0.04</td>
      <td id="T_42f38_row22_col4" class="data row22 col4" >0.01</td>
      <td id="T_42f38_row22_col5" class="data row22 col5" >0.05</td>
      <td id="T_42f38_row22_col6" class="data row22 col6" >-0.01</td>
      <td id="T_42f38_row22_col7" class="data row22 col7" >-0.01</td>
      <td id="T_42f38_row22_col8" class="data row22 col8" >0.02</td>
      <td id="T_42f38_row22_col9" class="data row22 col9" >0.03</td>
      <td id="T_42f38_row22_col10" class="data row22 col10" >-0.05</td>
      <td id="T_42f38_row22_col11" class="data row22 col11" >-0.11</td>
      <td id="T_42f38_row22_col12" class="data row22 col12" >0.10</td>
      <td id="T_42f38_row22_col13" class="data row22 col13" >0.04</td>
      <td id="T_42f38_row22_col14" class="data row22 col14" >-0.05</td>
      <td id="T_42f38_row22_col15" class="data row22 col15" >-0.02</td>
      <td id="T_42f38_row22_col16" class="data row22 col16" >0.09</td>
      <td id="T_42f38_row22_col17" class="data row22 col17" >0.07</td>
      <td id="T_42f38_row22_col18" class="data row22 col18" >-0.08</td>
      <td id="T_42f38_row22_col19" class="data row22 col19" >0.03</td>
      <td id="T_42f38_row22_col20" class="data row22 col20" >0.06</td>
      <td id="T_42f38_row22_col21" class="data row22 col21" >0.19</td>
      <td id="T_42f38_row22_col22" class="data row22 col22" >1.00</td>
    </tr>
  </tbody>
</table>




# 五、模型的理解、选择 -- CatBoost

&emsp;&emsp;我现在面临的是一个二分类问题，我需要预测个体是否接种了 `H1N1流感疫苗`和`季节性流感疫苗`. 像`逻辑回归`、`梯度提升树`，
常用于处理二分类问题。
- 我这里不用 `逻辑回归` ，因为此次数据集特征很多，且`逻辑回归`假定存在线性关系，从上述的可视化看出，较多特征与标签不存在线性关系；缺少特征选择机制，使用所有特征进行逻辑回归，可能会导致噪声特征的引入和过度拟合.

&emsp;&emsp;常见的梯度提升树模型，`XGBOOST`、`LightGBM`、`CatBoost`.

- `CatBoost` (categorical boosting), 相较于另外两者，对类别型特征的处理更为完善，其自行将类别型特征处理为数值型特征，且可以丰富特征维度，其预测性强，鲁棒性强。

- 从数据集来看，有较多的类别型特征，且缺失值占比排名前十的特征当中，有7个是类别型特征.

因此，对于这种存在大量类别型特征和缺失值的二分类问题，我使用CatBoost模型进行建模和预测。

# 六、模型训练、验证、测试 -- CatBoost


```python
from sklearn.impute import SimpleImputer # 用于数据预处理中的缺失值处理
from catboost import CatBoostClassifier # CatBoost分类器模型
from catboost import Pool, cv # 用于训练和评估CatBoost模型
from sklearn.metrics import roc_curve, roc_auc_score # 用于计算ROC曲线和AUC值
```

## 1. 数据集切分

- 为提高模型的泛化能力，避免过拟合，调用 [sklearn.model_selection.train_test_split](https://scikit-learn.org.cn/view/649.html) 来随机切分数据集为训练集和测试集。

![output2](https://img.tucang.cc/api/image/show/a99ce37253bb785001f566e5239387d2)


```python
from sklearn.model_selection import train_test_split
```


```python
# 将特征数据（features_df）和标签数据（labels_df）进行划分 8：2
X_train, X_test, y_train, y_test = train_test_split(features_df, labels_df, test_size=0.2, random_state=50)
```


```python
categorical_features_indices = np.where(X_train.dtypes != float)[0] # 分类特征索引
```

## 2. 超参数优化 & 预测

- 调用 [optuna](https://optuna.readthedocs.io/zh-cn/latest/tutorial/10_key_features/002_configurations.html) 进行[CatBoostClassifier](https://catboost.ai/en/docs/concepts/python-reference_catboostclassifier)超参数优化


```python
import optuna
```

![output3](https://img.tucang.cc/api/image/show/4237909a5689278a2468959b294c6e60)


```python
# 构建 train_dataset_h1 数据集
train_dataset_h1 = Pool(data=X_train,
                        label=y_train.h1n1_vaccine,
                        cat_features = categorical_features_indices)
```


```python
def objective1(trial):
    # 定义超参数搜索空间
    param = {
        'iterations': trial.suggest_categorical('iterations', [100, 200, 300, 500, 1000, 1200, 1500]),
        'auto_class_weights': trial.suggest_categorical('auto_class_weights', ['Balanced', 'SqrtBalanced']),
        'learning_rate': trial.suggest_float("learning_rate", 0.001, 0.3),
        'random_strength': trial.suggest_int("random_strength", 1, 10),
        'bagging_temperature': trial.suggest_int("bagging_temperature", 0, 10),
        'max_bin': trial.suggest_categorical('max_bin', [4, 5, 6, 8, 10, 20, 30]),
        'grow_policy': trial.suggest_categorical('grow_policy', ['SymmetricTree', 'Depthwise', 'Lossguide']),
        'min_data_in_leaf': trial.suggest_int("min_data_in_leaf", 1, 10),
        'od_type': "Iter",
        'od_wait': 100,
        "depth": trial.suggest_int("depth", 2, 10),
        "l2_leaf_reg": trial.suggest_float("l2_leaf_reg", 1e-8, 100, log=True),
        'one_hot_max_size': trial.suggest_categorical('one_hot_max_size', [5, 10, 12, 100, 500, 1024]),
        'custom_metric': ['Logloss', 'AUC'],
        "loss_function": "Logloss",
    }

    # 使用 CatBoost 的交叉验证函数进行模型评估
    scores = cv(train_dataset_h1,
                param,
                fold_count=5,
                early_stopping_rounds=10,
                plot=False, verbose=False)

    # 返回交叉验证中 AUC 最大的分数作为优化目标
    return scores['test-AUC-mean'].max()

```

- 通过 `optuna采样器` 的 [TPESampler](https://optuna.readthedocs.io/zh-cn/latest/reference/generated/optuna.samplers.TPESampler.html) 进行超参数优化


```python
from optuna.samplers import TPESampler
study = optuna.create_study(sampler=TPESampler(), direction="maximize")
study.optimize(objective1, n_trials=1)
```

    [I 2023-12-28 17:35:20,258] A new study created in memory with name: no-name-60393cc1-6863-421f-9dba-06744d868143


    Training on fold [0/5]
    
    bestTest = 0.4827874453
    bestIteration = 25
    
    Training on fold [1/5]
    
    bestTest = 0.4864917746
    bestIteration = 41
    
    Training on fold [2/5]
    
    bestTest = 0.4929792515
    bestIteration = 26
    
    Training on fold [3/5]
    
    bestTest = 0.5002491376
    bestIteration = 38
    
    Training on fold [4/5]


    [I 2023-12-28 17:35:22,092] Trial 0 finished with value: 0.8457264063947731 and parameters: {'iterations': 1000, 'auto_class_weights': 'Balanced', 'learning_rate': 0.1465169151209682, 'random_strength': 10, 'bagging_temperature': 5, 'max_bin': 5, 'grow_policy': 'SymmetricTree', 'min_data_in_leaf': 7, 'depth': 7, 'l2_leaf_reg': 0.00016464473810433216, 'one_hot_max_size': 1024}. Best is trial 0 with value: 0.8457264063947731.


​    
​    bestTest = 0.4890295168
​    bestIteration = 46


​    


```python
print(f"Number of finished trials: {len(study.trials)}")
print("Best trial:")
trial = study.best_trial
print(f"  Value: {trial.value}")
print("  Params: ")
for key, value in trial.params.items():
    print(f"    {key}={value},")
```

    Number of finished trials: 1
    Best trial:
      Value: 0.8457264063947731
      Params: 
        iterations=1000,
        auto_class_weights=Balanced,
        learning_rate=0.1465169151209682,
        random_strength=10,
        bagging_temperature=5,
        max_bin=5,
        grow_policy=SymmetricTree,
        min_data_in_leaf=7,
        depth=7,
        l2_leaf_reg=0.00016464473810433216,
        one_hot_max_size=1024,


### 2.1 创建 CatBoost 分类器 final_model_h1 进行预测


```python
final_model_h1 = CatBoostClassifier(verbose=False,
                                    cat_features=categorical_features_indices,
                                    **trial.params)
# + final_model_h1 = CatBoostClassifier(verbose=False,cat_features=categorical_features_indices, loss_function='CrossEntropy')
```


```python
# 使用 final_model_h1 对 train_dataset_h1 进行训练
final_model_h1.fit(train_dataset_h1)
```




    <catboost.core.CatBoostClassifier at 0x19c10b39490>




```python
predictions_h1 = final_model_h1.predict_proba(X_test)
```


```python
predictions_h1 = predictions_h1[:,1].reshape(-1,1)
```


```python
from sklearn.metrics import roc_curve, roc_auc_score
```


```python
def plot_roc(y_true, y_score, label_name, ax):
    fpr, tpr, thresholds = roc_curve(y_true, y_score)
    ax.plot(fpr, tpr)
    ax.plot([0, 1], [0, 1], color='grey', linestyle='--')
    ax.set_ylabel('TPR')
    ax.set_xlabel('FPR')
    ax.set_title(
        f"{label_name}: AUC = {roc_auc_score(y_true, y_score):.4f}"
    )
    
fig, ax = plt.subplots(1, 1, figsize=(10, 8))
plot_roc(
    y_test['h1n1_vaccine'], 
    predictions_h1, 
    'h1n1_vaccine',
    ax=ax
)
```


![output_91_0](https://img.tucang.cc/api/image/show/75ec01cd580ec9db21f0af820c64a7ed)



```python
roc_auc_score(y_test.h1n1_vaccine, predictions_h1)
```




    0.8624116312772383




```python
train_dataset_se = Pool(data=X_train,
                     label=y_train.seasonal_vaccine,
                     cat_features = categorical_features_indices)
```


```python
def objective2(trial):
    param = {
        'iterations':trial.suggest_categorical('iterations', [100,200,300,500,1000,1200,1500]),
        'learning_rate':trial.suggest_float("learning_rate", 0.001, 0.3),
        'random_strength':trial.suggest_int("random_strength", 1,10),
        'bagging_temperature':trial.suggest_int("bagging_temperature", 0,10),
        'max_bin':trial.suggest_categorical('max_bin', [4,5,6,8,10,20,30]),
        'grow_policy':trial.suggest_categorical('grow_policy', ['SymmetricTree', 'Depthwise', 'Lossguide']),
        'min_data_in_leaf':trial.suggest_int("min_data_in_leaf", 1,10),
        'od_type' : "Iter",
        'od_wait' : 100,
        "depth": trial.suggest_int("max_depth", 2,10),
        "l2_leaf_reg": trial.suggest_float("l2_leaf_reg", 1e-8, 100, log=True),
        'one_hot_max_size':trial.suggest_categorical('one_hot_max_size', [5,10,12,100,500,1024]),
        'custom_metric' : ['AUC'],
        "loss_function": "Logloss",
        'auto_class_weights':trial.suggest_categorical('auto_class_weights', ['Balanced', 'SqrtBalanced']),
        }

    scores = cv(train_dataset_se,
            param,
            fold_count=5, 
            early_stopping_rounds=10,         
            plot=False, verbose=False) 

    return scores['test-AUC-mean'].max()
```


```python
study2 = optuna.create_study(sampler=TPESampler(), direction="maximize")
study2.optimize(objective2, n_trials=1)
```

    [I 2023-12-28 17:36:35,703] A new study created in memory with name: no-name-2f2861da-1f53-4a2f-8793-615f2df87f56


    Training on fold [0/5]
    
    bestTest = 0.4830003578
    bestIteration = 44
    
    Training on fold [1/5]
    
    bestTest = 0.4672035603
    bestIteration = 45
    
    Training on fold [2/5]
    
    bestTest = 0.4832904288
    bestIteration = 45
    
    Training on fold [3/5]
    
    bestTest = 0.4842720356
    bestIteration = 44
    
    Training on fold [4/5]


    [I 2023-12-28 17:36:38,014] Trial 0 finished with value: 0.8512337669520788 and parameters: {'iterations': 300, 'learning_rate': 0.2818115853666999, 'random_strength': 9, 'bagging_temperature': 3, 'max_bin': 20, 'grow_policy': 'Depthwise', 'min_data_in_leaf': 2, 'max_depth': 6, 'l2_leaf_reg': 0.005851321082700687, 'one_hot_max_size': 100, 'auto_class_weights': 'SqrtBalanced'}. Best is trial 0 with value: 0.8512337669520788.


​    
​    bestTest = 0.4867891448
​    bestIteration = 48


​    


```python
print(f"Number of finished trials: {len(study2.trials)}")
print("Best trial:")
trial2 = study2.best_trial
print(f"  Value: {trial.value}")
print("  Params: ")
for key, value in trial2.params.items():
    print(f"    {key}={value},")
```

    Number of finished trials: 1
    Best trial:
      Value: 0.8457264063947731
      Params: 
        iterations=300,
        learning_rate=0.2818115853666999,
        random_strength=9,
        bagging_temperature=3,
        max_bin=20,
        grow_policy=Depthwise,
        min_data_in_leaf=2,
        max_depth=6,
        l2_leaf_reg=0.005851321082700687,
        one_hot_max_size=100,
        auto_class_weights=SqrtBalanced,


### 2.2 创建 CatBoost 分类器 final_model_se 进行预测


```python
final_model_se = CatBoostClassifier(verbose=False,
                                    cat_features=categorical_features_indices,
                                    **trial2.params)
# + final_model_se = CatBoostClassifier(verbose=False,cat_features=categorical_features_indices, loss_function='CrossEntropy')
```


```python
final_model_se.fit(train_dataset_se)
```




    <catboost.core.CatBoostClassifier at 0x19c10c8bfd0>




```python
predictions_se = final_model_se.predict_proba(X_test)
```


```python
predictions_se = predictions_se[:,1].reshape(-1,1)
```


```python
fig, ax = plt.subplots(1, 1, figsize=(10, 8))
plot_roc(
    y_test['seasonal_vaccine'], 
    predictions_se, 
    'seasonal_vaccine',
    ax=ax
)
```


![output_102_0](https://img.tucang.cc/api/image/show/42a6434fe3daccb526b1143c43413c94)



```python
roc_auc_score(y_test.seasonal_vaccine, predictions_se)
```




    0.8662482553101809




```python
roc_auc_score(y_test, np.hstack((predictions_h1, predictions_se)))
```




    0.8643299432937096



# 七、最终预测

## 1. H1n1_vaccine 预测

- 在完整数据集上预测 **h1n1_vaccine**


```python
final_model_h1.fit(features_df, labels_df.h1n1_vaccine)
```




    <catboost.core.CatBoostClassifier at 0x19c10b39490>




```python
final_h1 = final_model_h1.predict_proba(test_df)
```


```python
final_h1 = final_h1[:,1].reshape(-1,1)
```


```python
final_h1
```




    array([[0.12283344],
           [0.03105349],
           [0.20220141],
           ...,
           [0.1964233 ],
           [0.02112615],
           [0.54460577]])



## 2. Seasonal_vaccine 预测

- 在完整数据集上预测 **seasonal_vaccine**


```python
final_model_se.fit(features_df, labels_df.seasonal_vaccine)
```




    <catboost.core.CatBoostClassifier at 0x19c10c8bfd0>




```python
final_se = final_model_se.predict_proba(test_df)
```


```python
final_se = final_se[:,1].reshape(-1,1)
```


```python
final_se
```




    array([[0.22118574],
           [0.02546254],
           [0.7162168 ],
           ...,
           [0.20864703],
           [0.29718237],
           [0.59726648]])




```python
submission_df = pd.read_csv("data_sets/submission_format.csv",index_col="respondent_id")
```


```python
# 确保索引值一致
np.testing.assert_array_equal(test_df.index.values, submission_df.index.values)

submission_df["h1n1_vaccine"] = final_h1
submission_df["seasonal_vaccine"] = final_se

submission_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>h1n1_vaccine</th>
      <th>seasonal_vaccine</th>
    </tr>
    <tr>
      <th>respondent_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26707</th>
      <td>0.122833</td>
      <td>0.221186</td>
    </tr>
    <tr>
      <th>26708</th>
      <td>0.031053</td>
      <td>0.025463</td>
    </tr>
    <tr>
      <th>26709</th>
      <td>0.202201</td>
      <td>0.716217</td>
    </tr>
    <tr>
      <th>26710</th>
      <td>0.628900</td>
      <td>0.886977</td>
    </tr>
    <tr>
      <th>26711</th>
      <td>0.374536</td>
      <td>0.486767</td>
    </tr>
  </tbody>
</table>
</div>




```python
date = pd.Timestamp.now().strftime(format='%Y-%m-%d_%H-%M_')
submission_df.to_csv(f'predictions/{date}submssion_catboost_optuna.csv', index=True)
```

# 八、复盘总结

## 1. 模型历史性能变化

在近一个月时间里，我进行了30多次提交，我从6次较为显著变化里，总结一下。


```python
my_score = pd.DataFrame({'score':[0.8185,0.8600,0.8607,0.8609,0.7878,0.8627]})
```


```python
import matplotlib.pyplot as plt
import pandas as pd
plt.figure(figsize=(10, 6))
plt.plot(my_score['score'], marker='o', linestyle='-', color='b', label='Model Performance')
plt.title('Model Performance Over Time')
plt.xlabel('Iterations')
plt.ylabel('Score')
plt.grid(True)
plt.legend()
plt.show()
```


![output_125_0](https://img.tucang.cc/api/image/show/974f6c5ceb2600dc07c05cb60c2de66e)
    


- score = 0.8185 : 我参考基准博客，数值型列采用中位数填充，使用逻辑回归模型预测。
- score = 0.8600 : 使用optuna进行超参数优化，测验轮数100+，耗时(1h+)，使用梯度提升树模型 **catboost**，性能显著高于逻辑回归。
- score = 0.8607 : 在前者基础上，将缺失值填充策略进行更改，使用`SimpleImputer`类分别对数值列、分类列、有序列进行，平均值、常数、众数填充。
- score = 0.8609 : 训练集：测试集划分从 `7:3` -> `8:2`, cv交叉验证折叠数目从 `7`->`5`。
- score = 0.7878 ：将数值型列，与标签有较强关系的，如`h1n1_concern`和`opinion_seas_risk`等多元变量，转为分类特征，以供模型训练，可能是相关性过导致过高拟合，`roc-auc`还行，提交到网站上，分数很低，还没弄清楚原因。
- score = 0.8627 : 我决定把optuna超参数移除，直接使用`CatBoostClassifier(verbose=False,cat_features=categorical_features_indices, loss_function='CrossEntropy')`，效果挺好。

## 2. 最终排名

******
我的最终排名是: **158** 
- 在总参赛者排名：158/5488 `2.88%`
- 提交分数者排名：158/1773 `8.89%`

![my_rank](https://img.tucang.cc/api/image/show/c47225a3ebfaec4866edd4e9ee464e11)


```python
import seaborn as sns
import matplotlib.pyplot as plt
```


```python
rank_df = pd.read_csv('rank.csv')
```


```python
plt.figure(figsize=(10, 6))
sns.scatterplot(x=rank_df.index, y=rank_df['Score'], color='coral', alpha=0.7)

target_rank = 158
plt.scatter(x=target_rank, y=rank_df['Score'].iloc[target_rank], color='red', s=100, label='Rank 158')

plt.title('Final rank:158')
plt.xlabel('Index')
plt.ylabel('Score')
plt.legend()
plt.show()

```


![output_132_0](https://img.tucang.cc/api/image/show/aa23793c3e15da9423c46d37912a04e1)


******
&emsp;&emsp;还算是一个不错的成绩，更深一步的数据探索分析，进行特征工程，模型调优，增加optuna轮数等等，都可以提高模型性能。总之，这个模型还有很大的进步空间。
******
